<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Data Science with R">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Data Science with R (old posts, page 3) | Data Science with R</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="canonical" href="https://r.datascience.eu.org/posts/index-3.html">
<link rel="icon" href="../files/favicon.ico" sizes="16x16">
<link rel="prev" href="." type="text/html">
<link rel="next" href="index-2.html" type="text/html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="https://r.datascience.eu.org/">

            <span id="blog-title">Data Science with R</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../toc/" class="nav-link">Table of Contents</a>
                </li>
<li class="nav-item">
<a href="../categories/" class="nav-link">Categories</a>
                </li>
<li class="nav-item">
<a href="../tags/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="https://www.datascience.eu.org" class="nav-link">Main site</a>

                
            </li>
</ul>
<!-- DuckDuckGo custom search --><form method="get" id="search" action="https://duckduckgo.com/" class="navbar-form pull-left">
<input type="hidden" name="sites" value="https://r.datascience.eu.org/"><input type="hidden" name="k8" value="#444444"><input type="hidden" name="k9" value="#D51920"><input type="hidden" name="kt" value="h"><input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;"><input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->


            <ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        

    


    
<div class="postindex">
    <article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="00417/" class="u-url">Grouping and Chaining with dplyr</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Krishnakanth Allika
            </span></p>
            <p class="dateline">
            <a href="00417/" rel="bookmark">
            <time class="published dt-published" datetime="2020-04-23T20:38:07+05:30" itemprop="datePublished" title="2020-04-23 20:38">2020-04-23 20:38</time></a>
            </p>
                <p class="commentline">
        
<a href="%7Blink%7D" onclick="this.href='/posts/00417/'; this.target='_self';"><span class="IDCommentsReplace" style="display:none">cache/posts/00417_Grouping and Chaining with dplyr.html</span>
<script>
var idcomments_acct = '7fae5836cfdd49cac599cac5b95695d1';
var idcomments_post_id = "cache/posts/00417_Grouping and Chaining with dplyr.html";
var idcomments_post_url = "/posts/00417/";
</script><script src="https://www.intensedebate.com/js/genericLinkWrapperV2.js"></script></a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>R version 3.6.3 (2020-02-29) -- "Holding the Windsock"<br>
Copyright (C) 2020 The R Foundation for Statistical Computing<br>
Platform: x86_64-w64-mingw32/x64 (64-bit)</p>
<p>R is free software and comes with ABSOLUTELY NO WARRANTY.<br>
You are welcome to redistribute it under certain conditions.<br>
Type 'license()' or 'licence()' for distribution details.</p>
<p>R is a collaborative project with many contributors.<br>
Type 'contributors()' for more information and<br>
'citation()' on how to cite R or R packages in publications.</p>
<p>Type 'demo()' for some demos, 'help()' for on-line help, or<br>
'help.start()' for an HTML browser interface to help.<br>
Type 'q()' to quit R.</p>
<p>[Workspace loaded from C:/Users/kk/PortableApps/Git/home/k-allika/repos/DataScienceWithR/.RData]</p>
<blockquote>
<p>setwd("C:/Users/kk/PortableApps/Git/home/k-allika/repos/DataScienceWithR/03_Getting_and_Cleaning_Data/Week03/workspace")<br>
library(swirl)</p>
</blockquote>
<p>| Hi! Type swirl() when you are ready to begin.</p>
<blockquote>
<p>swirl()</p>
</blockquote>
<p>| Welcome to swirl! Please sign in. If you've been here before, use the same name as you<br>
| did then. If you are new, call yourself something unique.</p>
<p>What shall I call you? Krishnakanth allika</p>
<p>| Please choose a course, or type 0 to exit swirl.</p>
<p>1: Getting and Cleaning Data<br>
2: R Programming<br>
3: Take me to the swirl course repository!</p>
<p>Selection: 1</p>
<p>| Please choose a lesson, or type 0 to return to course menu.</p>
<p>1: Manipulating Data with dplyr<br>
2: Grouping and Chaining with dplyr<br>
3: Tidying Data with tidyr<br>
4: Dates and Times with lubridate</p>
<p>Selection: 2</p>
<p>| Attempting to load lesson dependencies...</p>
<p>| Package ‘dplyr’ loaded correctly!</p>
<p>|                                                                                |   0%</p>
<p>| Warning: This lesson makes use of the View() function. View() may not work properly in<br>
| every programming environment. We highly recommend the use of RStudio for this lesson.</p>
<p>...</p>
<p>|==                                                                              |   2%<br>
| In the last lesson, you learned about the five main data manipulation 'verbs' in dplyr:<br>
| select(), filter(), arrange(), mutate(), and summarize(). The last of these,<br>
| summarize(), is most powerful when applied to grouped data.</p>
<p>...</p>
<p>|===                                                                             |   4%<br>
| The main idea behind grouping data is that you want to break up your dataset into<br>
| groups of rows based on the values of one or more variables. The group_by() function is<br>
| reponsible for doing this.</p>
<p>...</p>
<p>|=====                                                                           |   6%<br>
| We'll continue where we left off with RStudio's CRAN download log from July 8, 2014,<br>
| which contains information on roughly 225,000 R package downloads<br>
| (<a href="http://cran-logs.rstudio.com/">http://cran-logs.rstudio.com/</a>).</p>
<p>...</p>
<p>|======                                                                          |   8%<br>
| As with the last lesson, the dplyr package was automatically installed (if necessary)<br>
| and loaded at the beginning of this lesson. Normally, this is something you would have<br>
| to do on your own. Just to build the habit, type library(dplyr) now to load the package<br>
| again.</p>
<blockquote>
<p>library(dplyr)</p>
</blockquote>
<p>| That's the answer I was looking for.</p>
<p>|========                                                                        |  10%<br>
| I've made the dataset available to you in a data frame called mydf. Put it in a 'data<br>
| frame tbl' using the tbl_df() function and store the result in a object called cran. If<br>
| you're not sure what I'm talking about, you should start with the previous lesson.<br>
| Otherwise, practice makes perfect!</p>
<blockquote>
<p>cran&lt;-as_tibble(mydf)</p>
</blockquote>
<p>| Not exactly. Give it another go. Or, type info() for more options.</p>
<p>| Type cran &lt;- tbl_df(mydf) to store the data in a new tbl_df called cran.</p>
<blockquote>
<p>cran&lt;-tbl_df(mydf)</p>
</blockquote>
<p>| You are doing so well!</p>
<p>|=========                                                                       |  12%<br>
| To avoid confusion and keep things running smoothly, let's remove the original<br>
| dataframe from your workspace with rm("mydf").</p>
<blockquote>
<p>rm("mydf")</p>
</blockquote>
<p>| All that hard work is paying off!</p>
<p>|===========                                                                     |  13%<br>
| Print cran to the console.</p>
<blockquote>
<p>cran<br>
# A tibble: 225,468 x 11<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07~ 00:54:~   80589 3.1.0     x86_64 mingw32 htmltools 0.2.4   US          1<br>
 2     2 2014-07~ 00:59:~  321767 3.1.0     x86_64 mingw32 tseries   0.10-32 US          2<br>
 3     3 2014-07~ 00:47:~  748063 3.1.0     x86_64 linux-~ party     1.0-15  US          3<br>
 4     4 2014-07~ 00:48:~  606104 3.1.0     x86_64 linux-~ Hmisc     3.14-4  US          3<br>
 5     5 2014-07~ 00:46:~   79825 3.0.2     x86_64 linux-~ digest    0.6.4   CA          4<br>
 6     6 2014-07~ 00:48:~   77681 3.1.0     x86_64 linux-~ randomFo~ 4.6-7   US          3<br>
 7     7 2014-07~ 00:48:~  393754 3.1.0     x86_64 linux-~ plyr      1.8.1   US          3<br>
 8     8 2014-07~ 00:47:~   28216 3.0.2     x86_64 linux-~ whisker   0.3-2   US          5<br>
 9     9 2014-07~ 00:54:~    5928 NA        NA     NA      Rcpp      0.10.4  CN          6<br>
10    10 2014-07~ 00:15:~ 2206029 3.0.2     x86_64 linux-~ hflights  0.1     US          7<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| You nailed it! Good job!</p>
<p>|============                                                                    |  15%<br>
| Our first goal is to group the data by package name. Bring up the help file for<br>
| group_by().</p>
<blockquote>
<p>group_by(cran,package)<br>
# A tibble: 225,468 x 11<br>
# Groups:   package [6,023]<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07~ 00:54:~   80589 3.1.0     x86_64 mingw32 htmltools 0.2.4   US          1<br>
 2     2 2014-07~ 00:59:~  321767 3.1.0     x86_64 mingw32 tseries   0.10-32 US          2<br>
 3     3 2014-07~ 00:47:~  748063 3.1.0     x86_64 linux-~ party     1.0-15  US          3<br>
 4     4 2014-07~ 00:48:~  606104 3.1.0     x86_64 linux-~ Hmisc     3.14-4  US          3<br>
 5     5 2014-07~ 00:46:~   79825 3.0.2     x86_64 linux-~ digest    0.6.4   CA          4<br>
 6     6 2014-07~ 00:48:~   77681 3.1.0     x86_64 linux-~ randomFo~ 4.6-7   US          3<br>
 7     7 2014-07~ 00:48:~  393754 3.1.0     x86_64 linux-~ plyr      1.8.1   US          3<br>
 8     8 2014-07~ 00:47:~   28216 3.0.2     x86_64 linux-~ whisker   0.3-2   US          5<br>
 9     9 2014-07~ 00:54:~    5928 NA        NA     NA      Rcpp      0.10.4  CN          6<br>
10    10 2014-07~ 00:15:~ 2206029 3.0.2     x86_64 linux-~ hflights  0.1     US          7<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| Keep trying! Or, type info() for more options.</p>
<p>| Use ?group_by to bring up the documentation.</p>
<blockquote>
<p>cran %&gt;% group_by(package)<br>
# A tibble: 225,468 x 11<br>
# Groups:   package [6,023]<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07~ 00:54:~   80589 3.1.0     x86_64 mingw32 htmltools 0.2.4   US          1<br>
 2     2 2014-07~ 00:59:~  321767 3.1.0     x86_64 mingw32 tseries   0.10-32 US          2<br>
 3     3 2014-07~ 00:47:~  748063 3.1.0     x86_64 linux-~ party     1.0-15  US          3<br>
 4     4 2014-07~ 00:48:~  606104 3.1.0     x86_64 linux-~ Hmisc     3.14-4  US          3<br>
 5     5 2014-07~ 00:46:~   79825 3.0.2     x86_64 linux-~ digest    0.6.4   CA          4<br>
 6     6 2014-07~ 00:48:~   77681 3.1.0     x86_64 linux-~ randomFo~ 4.6-7   US          3<br>
 7     7 2014-07~ 00:48:~  393754 3.1.0     x86_64 linux-~ plyr      1.8.1   US          3<br>
 8     8 2014-07~ 00:47:~   28216 3.0.2     x86_64 linux-~ whisker   0.3-2   US          5<br>
 9     9 2014-07~ 00:54:~    5928 NA        NA     NA      Rcpp      0.10.4  CN          6<br>
10    10 2014-07~ 00:15:~ 2206029 3.0.2     x86_64 linux-~ hflights  0.1     US          7<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| You almost had it, but not quite. Try again. Or, type info() for more options.</p>
<p>| Use ?group_by to bring up the documentation.</p>
<blockquote>
<p>?group_by</p>
</blockquote>
<p>| Your dedication is inspiring!</p>
<p>|==============                                                                  |  17%<br>
| Group cran by the package variable and store the result in a new object called<br>
| by_package.</p>
<blockquote>
<p>by_package&lt;-cran %&gt;% group_by(package)</p>
</blockquote>
<p>| That's not the answer I was looking for, but try again. Or, type info() for more<br>
| options.</p>
<p>| Store the result of group_by(cran, package) in a new object called by_package.</p>
<blockquote>
<p>by_package&lt;-group_by(cran,package)</p>
</blockquote>
<p>| You got it right!</p>
<p>|===============                                                                 |  19%<br>
| Let's take a look at by_package. Print it to the console.</p>
<blockquote>
<p>by_package<br>
# A tibble: 225,468 x 11<br>
# Groups:   package [6,023]<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07~ 00:54:~   80589 3.1.0     x86_64 mingw32 htmltools 0.2.4   US          1<br>
 2     2 2014-07~ 00:59:~  321767 3.1.0     x86_64 mingw32 tseries   0.10-32 US          2<br>
 3     3 2014-07~ 00:47:~  748063 3.1.0     x86_64 linux-~ party     1.0-15  US          3<br>
 4     4 2014-07~ 00:48:~  606104 3.1.0     x86_64 linux-~ Hmisc     3.14-4  US          3<br>
 5     5 2014-07~ 00:46:~   79825 3.0.2     x86_64 linux-~ digest    0.6.4   CA          4<br>
 6     6 2014-07~ 00:48:~   77681 3.1.0     x86_64 linux-~ randomFo~ 4.6-7   US          3<br>
 7     7 2014-07~ 00:48:~  393754 3.1.0     x86_64 linux-~ plyr      1.8.1   US          3<br>
 8     8 2014-07~ 00:47:~   28216 3.0.2     x86_64 linux-~ whisker   0.3-2   US          5<br>
 9     9 2014-07~ 00:54:~    5928 NA        NA     NA      Rcpp      0.10.4  CN          6<br>
10    10 2014-07~ 00:15:~ 2206029 3.0.2     x86_64 linux-~ hflights  0.1     US          7<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| Excellent work!</p>
<p>|=================                                                               |  21%<br>
| At the top of the output above, you'll see 'Groups: package', which tells us that this<br>
| tbl has been grouped by the package variable. Everything else looks the same, but now<br>
| any operation we apply to the grouped data will take place on a per package basis.</p>
<p>...</p>
<p>|==================                                                              |  23%<br>
| Recall that when we applied mean(size) to the original tbl_df via summarize(), it<br>
| returned a single number -- the mean of all values in the size column. We may care<br>
| about what that number is, but wouldn't it be so much more interesting to look at the<br>
| mean download size for each unique package?</p>
<p>...</p>
<p>|====================                                                            |  25%<br>
| That's exactly what you'll get if you use summarize() to apply mean(size) to the<br>
| grouped data in by_package. Give it a shot.</p>
<blockquote>
<p>summarise(by_package,mean(size))<br>
# A tibble: 6,023 x 2<br>
   package     <code>mean(size)</code><br><chr><dbl><br>
 1 A3                62195.<br>
 2 abc             4826665<br>
 3 abcdeFBA         455980.<br>
 4 ABCExtremes       22904.<br>
 5 ABCoptim          17807.<br>
 6 ABCp2             30473.<br>
 7 abctools        2589394<br>
 8 abd              453631.<br>
 9 abf2              35693.<br>
10 abind             32939.<br>
# ... with 6,013 more rows</dbl></chr></p>
</blockquote>
<p>| You got it right!</p>
<p>|======================                                                          |  27%<br>
| Instead of returning a single value, summarize() now returns the mean size for EACH<br>
| package in our dataset.</p>
<p>...</p>
<p>|=======================                                                         |  29%<br>
| Let's take it a step further. I just opened an R script for you that contains a<br>
| partially constructed call to summarize(). Follow the instructions in the script<br>
| comments.<br>
|<br>
| When you are ready to move on, save the script and type submit(), or type reset() to<br>
| reset the script to its original state.</p>
<blockquote>
<p>play()</p>
</blockquote>
<p>| Entering play mode. Experiment as you please, then type nxt() when you are ready to<br>
| resume the lesson.</p>
<blockquote>
<p>?n<br>
?n_distinct<br>
nxt()</p>
</blockquote>
<p>| Resuming lesson...</p>
<p>| Let's take it a step further. I just opened an R script for you that contains a<br>
| partially constructed call to summarize(). Follow the instructions in the script<br>
| comments.<br>
|<br>
| When you are ready to move on, save the script and type submit(), or type reset() to<br>
| reset the script to its original state.</p>

<pre><code>{r}
# Compute four values, in the following order, from
# the grouped data:
#
# 1. count = n()
# 2. unique = n_distinct(ip_id)
# 3. countries = n_distinct(country)
# 4. avg_bytes = mean(size)
#
# A few thing to be careful of:
#
# 1. Separate arguments by commas
# 2. Make sure you have a closing parenthesis
# 3. Check your spelling!
# 4. Store the result in pack_sum (for 'package summary')
#
# You should also take a look at ?n and ?n_distinct, so
# that you really understand what is going on.

pack_sum &lt;- summarize(by_package,
                      count = n(),
                      unique = n_distinct(ip_id),
                      countries = n_distinct(country),
                      avg_bytes = mean(size))</code></pre>
<blockquote>
<p>submit()</p>
</blockquote>
<p>| Sourcing your script...</p>
<p>| You are doing so well!</p>
<p>|=========================                                                       |  31%<br>
| Print the resulting tbl, pack_sum, to the console to examine its contents.</p>
<blockquote>
<p>pack_sum<br>
# A tibble: 6,023 x 5<br>
   package     count unique countries avg_bytes<br><chr><int><int><int><dbl><br>
 1 A3             25     24        10    62195.<br>
 2 abc            29     25        16  4826665<br>
 3 abcdeFBA       15     15         9   455980.<br>
 4 ABCExtremes    18     17         9    22904.<br>
 5 ABCoptim       16     15         9    17807.<br>
 6 ABCp2          18     17        10    30473.<br>
 7 abctools       19     19        11  2589394<br>
 8 abd            17     16        10   453631.<br>
 9 abf2           13     13         9    35693.<br>
10 abind         396    365        50    32939.<br>
# ... with 6,013 more rows</dbl></int></int></int></chr></p>
</blockquote>
<p>| That's the answer I was looking for.</p>
<p>|==========================                                                      |  33%<br>
| The 'count' column, created with n(), contains the total number of rows (i.e.<br>
| downloads) for each package. The 'unique' column, created with n_distinct(ip_id), gives<br>
| the total number of unique downloads for each package, as measured by the number of<br>
| distinct ip_id's. The 'countries' column, created with n_distinct(country), provides<br>
| the number of countries in which each package was downloaded. And finally, the<br>
| 'avg_bytes' column, created with mean(size), contains the mean download size (in bytes)<br>
| for each package.</p>
<p>...</p>
<p>|============================                                                    |  35%<br>
| It's important that you understand how each column of pack_sum was created and what it<br>
| means. Now that we've summarized the data by individual packages, let's play around<br>
| with it some more to see what we can learn.</p>
<p>...</p>
<p>|=============================                                                   |  37%<br>
| Naturally, we'd like to know which packages were most popular on the day these data<br>
| were collected (July 8, 2014). Let's start by isolating the top 1% of packages, based<br>
| on the total number of downloads as measured by the 'count' column.</p>
<p>...</p>
<p>|===============================                                                 |  38%<br>
| We need to know the value of 'count' that splits the data into the top 1% and bottom<br>
| 99% of packages based on total downloads. In statistics, this is called the 0.99, or<br>
| 99%, sample quantile. Use quantile(pack_sum$count, probs = 0.99) to determine this<br>
| number.</p>
<blockquote>
<p>quantile(pack_sum$count, probs = 0.99)<br>
   99%<br>
679.56</p>
</blockquote>
<p>| You're the best!</p>
<p>|================================                                                |  40%<br>
| Now we can isolate only those packages which had more than 679 total downloads. Use<br>
| filter() to select all rows from pack_sum for which 'count' is strictly greater (&gt;)<br>
| than 679. Store the result in a new object called top_counts.</p>
<blockquote>
<p>top_counts&lt;-filter(pack_sum,count&gt;679)</p>
</blockquote>
<p>| You are doing so well!</p>
<p>|==================================                                              |  42%<br>
| Let's take a look at top_counts. Print it to the console.</p>
<blockquote>
<p>top_counts<br>
# A tibble: 61 x 5<br>
   package    count unique countries avg_bytes<br><chr><int><int><int><dbl><br>
 1 bitops      1549   1408        76    28715.<br>
 2 car         1008    837        64  1229122.<br>
 3 caTools      812    699        64   176589.<br>
 4 colorspace  1683   1433        80   357411.<br>
 5 data.table   680    564        59  1252721.<br>
 6 DBI         2599    492        48   206933.<br>
 7 devtools     769    560        55   212933.<br>
 8 dichromat   1486   1257        74   134732.<br>
 9 digest      2210   1894        83   120549.<br>
10 doSNOW       740     75        24     8364.<br>
# ... with 51 more rows</dbl></int></int></int></chr></p>
</blockquote>
<p>| You are amazing!</p>
<p>|===================================                                             |  44%<br>
| There are only 61 packages in our top 1%, so we'd like to see all of them. Since dplyr<br>
| only shows us the first 10 rows, we can use the View() function to see more.</p>
<p>...</p>
<p>|=====================================                                           |  46%<br>
| View all 61 rows with View(top_counts). Note that the 'V' in View() is capitalized.</p>
<blockquote>
<p>View(top_counts)</p>
</blockquote>
<p><img src="../images/r0040180.png" alt="top_counts" title="top_counts"></p>
<p>| You're the best!</p>
<p>|======================================                                          |  48%<br>
| arrange() the rows of top_counts based on the 'count' column and assign the result to a<br>
| new object called top_counts_sorted. We want the packages with the highest number of<br>
| downloads at the top, which means we want 'count' to be in descending order. If you<br>
| need help, check out ?arrange and/or ?desc.</p>
<blockquote>
<p>top_counts_sorted&lt;-arrange(top_counts,count)</p>
</blockquote>
<p>| Almost! Try again. Or, type info() for more options.</p>
<p>| arrange(top_counts, desc(count)) will arrange the rows of top_counts based on the<br>
| values of the 'count' variable, in descending order. Don't forget to assign the result<br>
| to top_counts_sorted.</p>
<blockquote>
<p>top_counts_sorted&lt;-arrange(top_counts,desc(count))</p>
</blockquote>
<p>| All that hard work is paying off!</p>
<p>|========================================                                        |  50%<br>
| Now use View() again to see all 61 rows of top_counts_sorted.</p>
<blockquote>
<p>View(top_counts_sorted)</p>
</blockquote>
<p><img src="../images/r0040190.png" alt="top_counts_sorted" title="top_counts_sorted"></p>
<p>| You are amazing!</p>
<p>|==========================================                                      |  52%<br>
| If we use total number of downloads as our metric for popularity, then the above output<br>
| shows us the most popular packages downloaded from the RStudio CRAN mirror on July 8,<br>
| 2014. Not surprisingly, ggplot2 leads the pack with 4602 downloads, followed by Rcpp,<br>
| plyr, rJava, ....</p>
<p>...</p>
<p>|===========================================                                     |  54%<br>
| ...And if you keep on going, you'll see swirl at number 43, with 820 total downloads.<br>
| Sweet!</p>
<p>...</p>
<p>|=============================================                                   |  56%<br>
| Perhaps we're more interested in the number of <em>unique</em> downloads on this particular<br>
| day. In other words, if a package is downloaded ten times in one day from the same<br>
| computer, we may wish to count that as only one download. That's what the 'unique'<br>
| column will tell us.</p>
<p>...</p>
<p>|==============================================                                  |  58%<br>
| Like we did with 'count', let's find the 0.99, or 99%, quantile for the 'unique'<br>
| variable with quantile(pack_sum$unique, probs = 0.99).</p>
<blockquote>
<p>quantile(pack_sum$unique,probs = 0.99)<br>
99%<br>
465</p>
</blockquote>
<p>| Nice work!</p>
<p>|================================================                                |  60%<br>
| Apply filter() to pack_sum to select all rows corresponding to values of 'unique' that<br>
| are strictly greater than 465. Assign the result to a object called top_unique.</p>
<blockquote>
<p>top_unique&lt;-filter(pack_sum,unique&gt;465)</p>
</blockquote>
<p>| Keep up the great work!</p>
<p>|=================================================                               |  62%<br>
| Let's View() our top contenders!</p>
<blockquote>
<p>View(top_unique)</p>
</blockquote>
<p><img src="../images/r0040200.png" alt="top_unique" title="top_unique"></p>
<p>| That's a job well done!</p>
<p>|===================================================                             |  63%<br>
| Now arrange() top_unique by the 'unique' column, in descending order, to see which<br>
| packages were downloaded from the greatest number of unique IP addresses. Assign the<br>
| result to top_unique_sorted.</p>
<blockquote>
<p>top_unique_sorted&lt;-arrange(top_unique,desc(unique))</p>
</blockquote>
<p>| You are really on a roll!</p>
<p>|====================================================                            |  65%<br>
| View() the sorted data.</p>
<blockquote>
<p>View(top_unique_sorted)</p>
</blockquote>
<p><img src="../images/r0040210.png" alt="top_unique_sorted" title="top_unique_sorted"></p>
<p>| All that practice is paying off!</p>
<p>|======================================================                          |  67%<br>
| Now Rcpp is in the lead, followed by stringr, digest, plyr, and ggplot2. swirl moved up<br>
| a few spaces to number 40, with 698 unique downloads. Nice!</p>
<p>...</p>
<p>|=======================================================                         |  69%<br>
| Our final metric of popularity is the number of distinct countries from which each<br>
| package was downloaded. We'll approach this one a little differently to introduce you<br>
| to a method called 'chaining' (or 'piping').</p>
<p>...</p>
<p>|=========================================================                       |  71%<br>
| Chaining allows you to string together multiple function calls in a way that is compact<br>
| and readable, while still accomplishing the desired result. To make it more concrete,<br>
| let's compute our last popularity metric from scratch, starting with our original data.</p>
<p>...</p>
<p>|==========================================================                      |  73%<br>
| I've opened up a script that contains code similar to what you've seen so far. Don't<br>
| change anything. Just study it for a minute, make sure you understand everything that's<br>
| there, then submit() when you are ready to move on.</p>

<pre><code>{r}
# Don't change any of the code below. Just type submit()
# when you think you understand it.

# We've already done this part, but we're repeating it
# here for clarity.

by_package &lt;- group_by(cran, package)
pack_sum &lt;- summarize(by_package,
                      count = n(),
                      unique = n_distinct(ip_id),
                      countries = n_distinct(country),
                      avg_bytes = mean(size))

# Here's the new bit, but using the same approach we've
# been using this whole time.

top_countries &lt;- filter(pack_sum, countries &gt; 60)
result1 &lt;- arrange(top_countries, desc(countries), avg_bytes)

# Print the results to the console.
print(result1)</code></pre>
<blockquote>
<p>submit()</p>
</blockquote>
<p>| Sourcing your script...</p>
<p># A tibble: 46 x 5<br>
   package      count unique countries avg_bytes<br><chr><int><int><int><dbl><br>
 1 Rcpp          3195   2044        84  2512100.<br>
 2 digest        2210   1894        83   120549.<br>
 3 stringr       2267   1948        82    65277.<br>
 4 plyr          2908   1754        81   799123.<br>
 5 ggplot2       4602   1680        81  2427716.<br>
 6 colorspace    1683   1433        80   357411.<br>
 7 RColorBrewer  1890   1584        79    22764.<br>
 8 scales        1726   1408        77   126819.<br>
 9 bitops        1549   1408        76    28715.<br>
10 reshape2      2032   1652        76   330128.<br>
# ... with 36 more rows</dbl></int></int></int></chr></p>
<p>| That's a job well done!</p>
<p>|============================================================                    |  75%<br>
| It's worth noting that we sorted primarily by country, but used avg_bytes (in ascending<br>
| order) as a tie breaker. This means that if two packages were downloaded from the same<br>
| number of countries, the package with a smaller average download size received a higher<br>
| ranking.</p>
<p>...</p>
<p>|==============================================================                  |  77%<br>
| We'd like to accomplish the same result as the last script, but avoid saving our<br>
| intermediate results. This requires embedding function calls within one another.</p>
<p>...</p>
<p>|===============================================================                 |  79%<br>
| That's exactly what we've done in this script. The result is equivalent, but the code<br>
| is much less readable and some of the arguments are far away from the function to which<br>
| they belong. Again, just try to understand what is going on here, then submit() when<br>
| you are ready to see a better solution.</p>

<pre><code>{r}
# Don't change any of the code below. Just type submit()
# when you think you understand it. If you find it
# confusing, you're absolutely right!

result2 &lt;-
  arrange(
    filter(
      summarize(
        group_by(cran,
                 package
        ),
        count = n(),
        unique = n_distinct(ip_id),
        countries = n_distinct(country),
        avg_bytes = mean(size)
      ),
      countries &gt; 60
    ),
    desc(countries),
    avg_bytes
  )

print(result2)</code></pre>
<blockquote>
<p>submit()</p>
</blockquote>
<p>| Sourcing your script...</p>
<p># A tibble: 46 x 5<br>
   package      count unique countries avg_bytes<br><chr><int><int><int><dbl><br>
 1 Rcpp          3195   2044        84  2512100.<br>
 2 digest        2210   1894        83   120549.<br>
 3 stringr       2267   1948        82    65277.<br>
 4 plyr          2908   1754        81   799123.<br>
 5 ggplot2       4602   1680        81  2427716.<br>
 6 colorspace    1683   1433        80   357411.<br>
 7 RColorBrewer  1890   1584        79    22764.<br>
 8 scales        1726   1408        77   126819.<br>
 9 bitops        1549   1408        76    28715.<br>
10 reshape2      2032   1652        76   330128.<br>
# ... with 36 more rows</dbl></int></int></int></chr></p>
<p>| That's a job well done!</p>
<p>|=================================================================               |  81%<br>
| In this script, we've used a special chaining operator, %&gt;%, which was originally<br>
| introduced in the magrittr R package and has now become a key component of dplyr. You<br>
| can pull up the related documentation with ?chain. The benefit of %&gt;% is that it allows<br>
| us to chain the function calls in a linear fashion. The code to the right of %&gt;%<br>
| operates on the result from the code to the left of %&gt;%.<br>
|<br>
| Once again, just try to understand the code, then type submit() to continue.</p>

<pre><code>{r}
# Read the code below, but don't change anything. As
# you read it, you can pronounce the %&gt;% operator as
# the word 'then'.
#
# Type submit() when you think you understand
# everything here.

result3 &lt;-
  cran %&gt;%
  group_by(package) %&gt;%
  summarize(count = n(),
            unique = n_distinct(ip_id),
            countries = n_distinct(country),
            avg_bytes = mean(size)
  ) %&gt;%
  filter(countries &gt; 60) %&gt;%
  arrange(desc(countries), avg_bytes)

# Print result to console
print(result3)</code></pre>
<blockquote>
<p>submit()</p>
</blockquote>
<p>| Sourcing your script...</p>
<p># A tibble: 46 x 5<br>
   package      count unique countries avg_bytes<br><chr><int><int><int><dbl><br>
 1 Rcpp          3195   2044        84  2512100.<br>
 2 digest        2210   1894        83   120549.<br>
 3 stringr       2267   1948        82    65277.<br>
 4 plyr          2908   1754        81   799123.<br>
 5 ggplot2       4602   1680        81  2427716.<br>
 6 colorspace    1683   1433        80   357411.<br>
 7 RColorBrewer  1890   1584        79    22764.<br>
 8 scales        1726   1408        77   126819.<br>
 9 bitops        1549   1408        76    28715.<br>
10 reshape2      2032   1652        76   330128.<br>
# ... with 36 more rows</dbl></int></int></int></chr></p>
<p>| You nailed it! Good job!</p>
<p>|==================================================================              |  83%<br>
| So, the results of the last three scripts are all identical. But, the third script<br>
| provides a convenient and concise alternative to the more traditional method that we've<br>
| taken previously, which involves saving results as we go along.</p>
<p>...</p>
<p>|====================================================================            |  85%<br>
| Once again, let's View() the full data, which has been stored in result3.</p>
<blockquote>
<p>View(result3)</p>
</blockquote>
<p><img src="../images/r0040220.png" alt="result3" title="result3"></p>
<p>| That's correct!</p>
<p>|=====================================================================           |  87%<br>
| It looks like Rcpp is on top with downloads from 84 different countries, followed by<br>
| digest, stringr, plyr, and ggplot2. swirl jumped up the rankings again, this time to<br>
| 27th.</p>
<p>...</p>
<p>|=======================================================================         |  88%<br>
| To help drive the point home, let's work through a few more examples of chaining.</p>
<p>...</p>
<p>|========================================================================        |  90%<br>
| Let's build a chain of dplyr commands one step at a time, starting with the script I<br>
| just opened for you.</p>

<pre><code>{r}
# select() the following columns from cran. Keep in mind
# that when you're using the chaining operator, you don't
# need to specify the name of the data tbl in your call to
# select().
#
# 1. ip_id
# 2. country
# 3. package
# 4. size
#
# The call to print() at the end of the chain is optional,
# but necessary if you want your results printed to the
# console. Note that since there are no additional arguments
# to print(), you can leave off the parentheses after
# the function name. This is a convenient feature of the %&gt;%
# operator.

cran %&gt;%
  select(ip_id,country,package,size) %&gt;%
    print</code></pre>
<blockquote>
<p>submit()</p>
</blockquote>
<p>| Sourcing your script...</p>
<p># A tibble: 225,468 x 4<br>
   ip_id country package         size<br><int><chr><chr><int><br>
 1     1 US      htmltools      80589<br>
 2     2 US      tseries       321767<br>
 3     3 US      party         748063<br>
 4     3 US      Hmisc         606104<br>
 5     4 CA      digest         79825<br>
 6     3 US      randomForest   77681<br>
 7     3 US      plyr          393754<br>
 8     5 US      whisker        28216<br>
 9     6 CN      Rcpp            5928<br>
10     7 US      hflights     2206029<br>
# ... with 225,458 more rows</int></chr></chr></int></p>
<p>| All that hard work is paying off!</p>
<p>|==========================================================================      |  92%<br>
| Let's add to the chain.</p>

<pre><code>{r}
# Use mutate() to add a column called size_mb that contains
# the size of each download in megabytes (i.e. size / 2^20).
#
# If you want your results printed to the console, add
# print to the end of your chain.

cran %&gt;%
  select(ip_id, country, package, size) %&gt;%
  mutate(size_mb=size/2^20) %&gt;%
  print</code></pre>
<blockquote>
<p>submit()</p>
</blockquote>
<p>| Sourcing your script...</p>
<p># A tibble: 225,468 x 5<br>
   ip_id country package         size size_mb<br><int><chr><chr><int><dbl><br>
 1     1 US      htmltools      80589 0.0769<br>
 2     2 US      tseries       321767 0.307<br>
 3     3 US      party         748063 0.713<br>
 4     3 US      Hmisc         606104 0.578<br>
 5     4 CA      digest         79825 0.0761<br>
 6     3 US      randomForest   77681 0.0741<br>
 7     3 US      plyr          393754 0.376<br>
 8     5 US      whisker        28216 0.0269<br>
 9     6 CN      Rcpp            5928 0.00565<br>
10     7 US      hflights     2206029 2.10<br>
# ... with 225,458 more rows</dbl></int></chr></chr></int></p>
<p>| All that practice is paying off!</p>
<p>|===========================================================================     |  94%<br>
| A little bit more now.</p>

<pre><code>{r}
# Use filter() to select all rows for which size_mb is
# less than or equal to (&lt;=) 0.5.
#
# If you want your results printed to the console, add
# print to the end of your chain.

cran %&gt;%
  select(ip_id, country, package, size) %&gt;%
  mutate(size_mb = size / 2^20) %&gt;%
  # Your call to filter() goes here
  filter(size_mb&lt;=0.5) %&gt;%
  print</code></pre>
<blockquote>
<p>submit()</p>
</blockquote>
<p>| Sourcing your script...</p>
<p># A tibble: 142,021 x 5<br>
   ip_id country package        size size_mb<br><int><chr><chr><int><dbl><br>
 1     1 US      htmltools     80589 0.0769<br>
 2     2 US      tseries      321767 0.307<br>
 3     4 CA      digest        79825 0.0761<br>
 4     3 US      randomForest  77681 0.0741<br>
 5     3 US      plyr         393754 0.376<br>
 6     5 US      whisker       28216 0.0269<br>
 7     6 CN      Rcpp           5928 0.00565<br>
 8    13 DE      ipred        186685 0.178<br>
 9    14 US      mnormt        36204 0.0345<br>
10    16 US      iterators    289972 0.277<br>
# ... with 142,011 more rows</dbl></int></chr></chr></int></p>
<p>| You got it!</p>
<p>|=============================================================================   |  96%<br>
| And finish it off.</p>

<pre><code>{r}
# arrange() the result by size_mb, in descending order.
#
# If you want your results printed to the console, add
# print to the end of your chain.

cran %&gt;%
  select(ip_id, country, package, size) %&gt;%
  mutate(size_mb = size / 2^20) %&gt;%
  filter(size_mb &lt;= 0.5) %&gt;%
  # Your call to arrange() goes here
  arrange(desc(size_mb)) %&gt;%
  print</code></pre>
<blockquote>
<p>submit()</p>
</blockquote>
<p>| Sourcing your script...</p>
<p># A tibble: 142,021 x 5<br>
   ip_id country package                 size size_mb<br><int><chr><chr><int><dbl><br>
 1 11034 DE      phia                  524232   0.500<br>
 2  9643 US      tis                   524152   0.500<br>
 3  1542 IN      RcppSMC               524060   0.500<br>
 4 12354 US      lessR                 523916   0.500<br>
 5 12072 US      colorspace            523880   0.500<br>
 6  2514 KR      depmixS4              523863   0.500<br>
 7  1111 US      depmixS4              523858   0.500<br>
 8  8865 CR      depmixS4              523858   0.500<br>
 9  5908 CN      RcmdrPlugin.KMggplot2 523852   0.500<br>
10 12354 US      RcmdrPlugin.KMggplot2 523852   0.500<br>
# ... with 142,011 more rows</dbl></int></chr></chr></int></p>
<p>| You got it!</p>
<p>|==============================================================================  |  98%<br>
| In this lesson, you learned about grouping and chaining using dplyr. You combined some<br>
| of the things you learned in the previous lesson with these more advanced ideas to<br>
| produce concise, readable, and highly effective code. Welcome to the wonderful world of<br>
| dplyr!</p>
<p>...</p>
<p>|================================================================================| 100%<br>
| Would you like to receive credit for completing this course on Coursera.org?</p>
<p>1: Yes<br>
2: No</p>
<p>Selection: 1<br>
What is your email address? xxxxxx@xxxxxxxxxxxx<br>
What is your assignment token? xXxXxxXXxXxxXXXx<br>
Grade submission succeeded!</p>
<p>| Perseverance, that's the answer.</p>
<p>| You've reached the end of this lesson! Returning to the main menu...</p>
<p>| Please choose a course, or type 0 to exit swirl.</p>
<p>1: Getting and Cleaning Data<br>
2: R Programming<br>
3: Take me to the swirl course repository!</p>
<p>Selection: 0</p>
<p>| Leaving swirl now. Type swirl() to resume.</p>
<blockquote>
<p>ls()<br>
 [1] "by_package"        "cran"              "pack_sum"          "result1"<br>
 [5] "result2"           "result3"           "top_countries"     "top_counts"<br>
 [9] "top_counts_sorted" "top_unique"        "top_unique_sorted"<br>
rm(list=ls())</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Last updated 2020-04-23 21:01:55.271179 IST</em></p>

</div>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="00416/" class="u-url">Manipulating Data with dplyr</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Krishnakanth Allika
            </span></p>
            <p class="dateline">
            <a href="00416/" rel="bookmark">
            <time class="published dt-published" datetime="2020-04-23T20:25:23+05:30" itemprop="datePublished" title="2020-04-23 20:25">2020-04-23 20:25</time></a>
            </p>
                <p class="commentline">
        
<a href="%7Blink%7D" onclick="this.href='/posts/00416/'; this.target='_self';"><span class="IDCommentsReplace" style="display:none">cache/posts/00416_Manipulating Data with dplyr.html</span>
<script>
var idcomments_acct = '7fae5836cfdd49cac599cac5b95695d1';
var idcomments_post_id = "cache/posts/00416_Manipulating Data with dplyr.html";
var idcomments_post_url = "/posts/00416/";
</script><script src="https://www.intensedebate.com/js/genericLinkWrapperV2.js"></script></a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>setwd("C:/Users/kk/PortableApps/Git/home/k-allika/repos/DataScienceWithR/03_Getting_and_Cleaning_Data/Week03/workspace")<br>
library(swirl)</p>
</blockquote>
<p>| Hi! Type swirl() when you are ready to begin.</p>
<blockquote>
<p>install_course("Getting and Cleaning Data")<br>
  |================================================================================| 100%</p>
</blockquote>
<p>| Course installed successfully!</p>
<blockquote>
<p>swirl()</p>
</blockquote>
<p>| Welcome to swirl! Please sign in. If you've been here before, use the same name as you<br>
| did then. If you are new, call yourself something unique.</p>
<p>What shall I call you? Krishnakanth Allika</p>
<p>| Please choose a course, or type 0 to exit swirl.</p>
<p>1: Getting and Cleaning Data<br>
2: R Programming<br>
3: Take me to the swirl course repository!</p>
<p>Selection: 1</p>
<p>| Please choose a lesson, or type 0 to return to course menu.</p>
<p>1: Manipulating Data with dplyr<br>
2: Grouping and Chaining with dplyr<br>
3: Tidying Data with tidyr<br>
4: Dates and Times with lubridate</p>
<p>Selection: 1</p>
<p>| Attempting to load lesson dependencies...</p>
<p>| This lesson requires the ‘dplyr’ package. Would you like me to install it for you now?</p>
<p>1: Yes<br>
2: No</p>
<p>Selection: 1</p>
<p>| Trying to install package ‘dplyr’ now...<br>
also installing the dependencies ‘utf8’, ‘lifecycle’, ‘pillar’, ‘vctrs’, ‘purrr’, ‘pkgconfig’, ‘tibble’, ‘tidyselect’, ‘BH’, ‘plogr’</p>
<p>There is a binary version available but the source version is later:<br>
       binary source needs_compilation<br>
tibble  3.0.0  3.0.1              TRUE</p>
<p>Binaries will be installed<br>
package ‘utf8’ successfully unpacked and MD5 sums checked<br>
package ‘lifecycle’ successfully unpacked and MD5 sums checked<br>
package ‘pillar’ successfully unpacked and MD5 sums checked<br>
package ‘vctrs’ successfully unpacked and MD5 sums checked<br>
package ‘purrr’ successfully unpacked and MD5 sums checked<br>
package ‘pkgconfig’ successfully unpacked and MD5 sums checked<br>
package ‘tibble’ successfully unpacked and MD5 sums checked<br>
package ‘tidyselect’ successfully unpacked and MD5 sums checked<br>
package ‘BH’ successfully unpacked and MD5 sums checked<br>
package ‘plogr’ successfully unpacked and MD5 sums checked<br>
package ‘dplyr’ successfully unpacked and MD5 sums checked</p>
<p>| Package ‘dplyr’ loaded correctly!</p>
<p>|                                                                                |   0%</p>
<p>| In this lesson, you'll learn how to manipulate data using dplyr. dplyr is a fast and<br>
| powerful R package written by Hadley Wickham and Romain Francois that provides a<br>
| consistent and concise grammar for manipulating tabular data.</p>
<p>...</p>
<p>|=                                                                               |   2%<br>
| One unique aspect of dplyr is that the same set of tools allow you to work with tabular<br>
| data from a variety of sources, including data frames, data tables, databases and<br>
| multidimensional arrays. In this lesson, we'll focus on data frames, but everything you<br>
| learn will apply equally to other formats.</p>
<p>...</p>
<p>|===                                                                             |   3%<br>
| As you may know, "CRAN is a network of ftp and web servers around the world that store<br>
| identical, up-to-date, versions of code and documentation for R"<br>
| (<a href="http://cran.rstudio.com/">http://cran.rstudio.com/</a>). RStudio maintains one of these so-called 'CRAN mirrors' and<br>
| they generously make their download logs publicly available<br>
| (<a href="http://cran-logs.rstudio.com/">http://cran-logs.rstudio.com/</a>). We'll be working with the log from July 8, 2014, which<br>
| contains information on roughly 225,000 package downloads.</p>
<p>...</p>
<p>|====                                                                            |   5%<br>
| I've created a variable called path2csv, which contains the full file path to the<br>
| dataset. Call read.csv() with two arguments, path2csv and stringsAsFactors = FALSE, and<br>
| save the result in a new variable called mydf. Check ?read.csv if you need help.</p>
<blockquote>
<p>mydf&lt;-read.csv(path2csv,stringsAsFactors = FALSE)</p>
</blockquote>
<p>| Excellent work!</p>
<p>|=====                                                                           |   7%<br>
| Use dim() to look at the dimensions of mydf.</p>
<blockquote>
<p>dim(mydf)<br>
[1] 225468     11</p>
</blockquote>
<p>| You are doing so well!</p>
<p>|=======                                                                         |   8%<br>
| Now use head() to preview the data.</p>
<blockquote>
<p>head(mydf)<br>
  X       date     time   size r_version r_arch      r_os      package version country<br>
1 1 2014-07-08 00:54:41  80589     3.1.0 x86_64   mingw32    htmltools   0.2.4      US<br>
2 2 2014-07-08 00:59:53 321767     3.1.0 x86_64   mingw32      tseries 0.10-32      US<br>
3 3 2014-07-08 00:47:13 748063     3.1.0 x86_64 linux-gnu        party  1.0-15      US<br>
4 4 2014-07-08 00:48:05 606104     3.1.0 x86_64 linux-gnu        Hmisc  3.14-4      US<br>
5 5 2014-07-08 00:46:50  79825     3.0.2 x86_64 linux-gnu       digest   0.6.4      CA<br>
6 6 2014-07-08 00:48:04  77681     3.1.0 x86_64 linux-gnu randomForest   4.6-7      US<br>
  ip_id<br>
1     1<br>
2     2<br>
3     3<br>
4     3<br>
5     4<br>
6     3</p>
</blockquote>
<p>| Excellent work!</p>
<p>|========                                                                        |  10%<br>
| The dplyr package was automatically installed (if necessary) and loaded at the<br>
| beginning of this lesson. Normally, this is something you would have to do on your own.<br>
| Just to build the habit, type library(dplyr) now to load the package again.</p>
<blockquote>
<p>library(dplyr)</p>
</blockquote>
<p>| Excellent work!</p>
<p>|=========                                                                       |  12%<br>
| It's important that you have dplyr version 0.4.0 or later. To confirm this, type<br>
| packageVersion("dplyr").</p>
<blockquote>
<p>packageVersion("dplyr")<br>
[1] ‘0.8.5’</p>
</blockquote>
<p>| Excellent work!</p>
<p>|===========                                                                     |  13%<br>
| If your dplyr version is not at least 0.4.0, then you should hit the Esc key now,<br>
| reinstall dplyr, then resume this lesson where you left off.</p>
<p>...</p>
<p>|============                                                                    |  15%<br>
| The first step of working with data in dplyr is to load the data into what the package<br>
| authors call a 'data frame tbl' or 'tbl_df'. Use the following code to create a new<br>
| tbl_df called cran:<br>
|<br>
| cran &lt;- tbl_df(mydf).</p>
<blockquote>
<p>cran &lt;- tbl_df(mydf)</p>
</blockquote>
<p>| You are doing so well!</p>
<p>|=============                                                                   |  17%<br>
| To avoid confusion and keep things running smoothly, let's remove the original data<br>
| frame from your workspace with rm("mydf").</p>
<blockquote>
<p>rm("mydf")</p>
</blockquote>
<p>| You are quite good my friend!</p>
<p>|===============                                                                 |  18%<br>
| From ?tbl_df, "The main advantage to using a tbl_df over a regular data frame is the<br>
| printing." Let's see what is meant by this. Type cran to print our tbl_df to the<br>
| console.</p>
<blockquote>
<p>cran<br>
# A tibble: 225,468 x 11<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07~ 00:54:~   80589 3.1.0     x86_64 mingw32 htmltools 0.2.4   US          1<br>
 2     2 2014-07~ 00:59:~  321767 3.1.0     x86_64 mingw32 tseries   0.10-32 US          2<br>
 3     3 2014-07~ 00:47:~  748063 3.1.0     x86_64 linux-~ party     1.0-15  US          3<br>
 4     4 2014-07~ 00:48:~  606104 3.1.0     x86_64 linux-~ Hmisc     3.14-4  US          3<br>
 5     5 2014-07~ 00:46:~   79825 3.0.2     x86_64 linux-~ digest    0.6.4   CA          4<br>
 6     6 2014-07~ 00:48:~   77681 3.1.0     x86_64 linux-~ randomFo~ 4.6-7   US          3<br>
 7     7 2014-07~ 00:48:~  393754 3.1.0     x86_64 linux-~ plyr      1.8.1   US          3<br>
 8     8 2014-07~ 00:47:~   28216 3.0.2     x86_64 linux-~ whisker   0.3-2   US          5<br>
 9     9 2014-07~ 00:54:~    5928 NA        NA     NA      Rcpp      0.10.4  CN          6<br>
10    10 2014-07~ 00:15:~ 2206029 3.0.2     x86_64 linux-~ hflights  0.1     US          7<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| All that hard work is paying off!</p>
<p>|================                                                                |  20%<br>
| This output is much more informative and compact than what we would get if we printed<br>
| the original data frame (mydf) to the console.</p>
<p>...</p>
<p>|=================                                                               |  22%<br>
| First, we are shown the class and dimensions of the dataset. Just below that, we get a<br>
| preview of the data. Instead of attempting to print the entire dataset, dplyr just<br>
| shows us the first 10 rows of data and only as many columns as fit neatly in our<br>
| console. At the bottom, we see the names and classes for any variables that didn't fit<br>
| on our screen.</p>
<p>...</p>
<p>|===================                                                             |  23%<br>
| According to the "Introduction to dplyr" vignette written by the package authors, "The<br>
| dplyr philosophy is to have small functions that each do one thing well." Specifically,<br>
| dplyr supplies five 'verbs' that cover most fundamental data manipulation tasks:<br>
| select(), filter(), arrange(), mutate(), and summarize().</p>
<p>...</p>
<p>|====================                                                            |  25%<br>
| Use ?select to pull up the documentation for the first of these core functions.</p>
<blockquote>
<p>?select</p>
</blockquote>
<p>| Your dedication is inspiring!</p>
<p>|=====================                                                           |  27%<br>
| Help files for the other functions are accessible in the same way.</p>
<p>...</p>
<p>|=======================                                                         |  28%<br>
| As may often be the case, particularly with larger datasets, we are only interested in<br>
| some of the variables. Use select(cran, ip_id, package, country) to select only the<br>
| ip_id, package, and country variables from the cran dataset.</p>
<blockquote>
<p>select(cran, ip_id, package, country)<br>
# A tibble: 225,468 x 3<br>
   ip_id package      country<br><int><chr><chr><br>
 1     1 htmltools    US<br>
 2     2 tseries      US<br>
 3     3 party        US<br>
 4     3 Hmisc        US<br>
 5     4 digest       CA<br>
 6     3 randomForest US<br>
 7     3 plyr         US<br>
 8     5 whisker      US<br>
 9     6 Rcpp         CN<br>
10     7 hflights     US<br>
# ... with 225,458 more rows</chr></chr></int></p>
</blockquote>
<p>| You are quite good my friend!</p>
<p>|========================                                                        |  30%<br>
| The first thing to notice is that we don't have to type cran$ip_id, cran$package, and<br>
| cran$country, as we normally would when referring to columns of a data frame. The<br>
| select() function knows we are referring to columns of the cran dataset.</p>
<p>...</p>
<p>|=========================                                                       |  32%<br>
| Also, note that the columns are returned to us in the order we specified, even though<br>
| ip_id is the rightmost column in the original dataset.</p>
<p>...</p>
<p>|===========================                                                     |  33%<br>
| Recall that in R, the <code>:</code> operator provides a compact notation for creating a sequence<br>
| of numbers. For example, try 5:20.</p>
<blockquote>
<p>5:20<br>
 [1]  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</p>
</blockquote>
<p>| All that practice is paying off!</p>
<p>|============================                                                    |  35%<br>
| Normally, this notation is reserved for numbers, but select() allows you to specify a<br>
| sequence of columns this way, which can save a bunch of typing. Use select(cran,<br>
| r_arch:country) to select all columns starting from r_arch and ending with country.</p>
<blockquote>
<p>select(cran,r_arch:country)<br>
# A tibble: 225,468 x 5<br>
   r_arch r_os      package      version country<br><chr><chr><chr><chr><chr><br>
 1 x86_64 mingw32   htmltools    0.2.4   US<br>
 2 x86_64 mingw32   tseries      0.10-32 US<br>
 3 x86_64 linux-gnu party        1.0-15  US<br>
 4 x86_64 linux-gnu Hmisc        3.14-4  US<br>
 5 x86_64 linux-gnu digest       0.6.4   CA<br>
 6 x86_64 linux-gnu randomForest 4.6-7   US<br>
 7 x86_64 linux-gnu plyr         1.8.1   US<br>
 8 x86_64 linux-gnu whisker      0.3-2   US<br>
 9 NA     NA        Rcpp         0.10.4  CN<br>
10 x86_64 linux-gnu hflights     0.1     US<br>
# ... with 225,458 more rows</chr></chr></chr></chr></chr></p>
</blockquote>
<p>| You are quite good my friend!</p>
<p>|=============================                                                   |  37%<br>
| We can also select the same columns in reverse order. Give it a try.</p>
<blockquote>
<p>select(cran,country:r_arch)<br>
# A tibble: 225,468 x 5<br>
   country version package      r_os      r_arch<br><chr><chr><chr><chr><chr><br>
 1 US      0.2.4   htmltools    mingw32   x86_64<br>
 2 US      0.10-32 tseries      mingw32   x86_64<br>
 3 US      1.0-15  party        linux-gnu x86_64<br>
 4 US      3.14-4  Hmisc        linux-gnu x86_64<br>
 5 CA      0.6.4   digest       linux-gnu x86_64<br>
 6 US      4.6-7   randomForest linux-gnu x86_64<br>
 7 US      1.8.1   plyr         linux-gnu x86_64<br>
 8 US      0.3-2   whisker      linux-gnu x86_64<br>
 9 CN      0.10.4  Rcpp         NA        NA<br>
10 US      0.1     hflights     linux-gnu x86_64<br>
# ... with 225,458 more rows</chr></chr></chr></chr></chr></p>
</blockquote>
<p>| You're the best!</p>
<p>|===============================                                                 |  38%<br>
| Print the entire dataset again, just to remind yourself of what it looks like. You can<br>
| do this at anytime during the lesson.</p>
<blockquote>
<p>cran<br>
# A tibble: 225,468 x 11<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07~ 00:54:~   80589 3.1.0     x86_64 mingw32 htmltools 0.2.4   US          1<br>
 2     2 2014-07~ 00:59:~  321767 3.1.0     x86_64 mingw32 tseries   0.10-32 US          2<br>
 3     3 2014-07~ 00:47:~  748063 3.1.0     x86_64 linux-~ party     1.0-15  US          3<br>
 4     4 2014-07~ 00:48:~  606104 3.1.0     x86_64 linux-~ Hmisc     3.14-4  US          3<br>
 5     5 2014-07~ 00:46:~   79825 3.0.2     x86_64 linux-~ digest    0.6.4   CA          4<br>
 6     6 2014-07~ 00:48:~   77681 3.1.0     x86_64 linux-~ randomFo~ 4.6-7   US          3<br>
 7     7 2014-07~ 00:48:~  393754 3.1.0     x86_64 linux-~ plyr      1.8.1   US          3<br>
 8     8 2014-07~ 00:47:~   28216 3.0.2     x86_64 linux-~ whisker   0.3-2   US          5<br>
 9     9 2014-07~ 00:54:~    5928 NA        NA     NA      Rcpp      0.10.4  CN          6<br>
10    10 2014-07~ 00:15:~ 2206029 3.0.2     x86_64 linux-~ hflights  0.1     US          7<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| Keep working like that and you'll get there!</p>
<p>|================================                                                |  40%<br>
| Instead of specifying the columns we want to keep, we can also specify the columns we<br>
| want to throw away. To see how this works, do select(cran, -time) to omit the time<br>
| column.</p>
<blockquote>
<p>select(cran,-time)<br>
# A tibble: 225,468 x 10<br>
       X date          size r_version r_arch r_os      package      version country ip_id<br><int><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07-08   80589 3.1.0     x86_64 mingw32   htmltools    0.2.4   US          1<br>
 2     2 2014-07-08  321767 3.1.0     x86_64 mingw32   tseries      0.10-32 US          2<br>
 3     3 2014-07-08  748063 3.1.0     x86_64 linux-gnu party        1.0-15  US          3<br>
 4     4 2014-07-08  606104 3.1.0     x86_64 linux-gnu Hmisc        3.14-4  US          3<br>
 5     5 2014-07-08   79825 3.0.2     x86_64 linux-gnu digest       0.6.4   CA          4<br>
 6     6 2014-07-08   77681 3.1.0     x86_64 linux-gnu randomForest 4.6-7   US          3<br>
 7     7 2014-07-08  393754 3.1.0     x86_64 linux-gnu plyr         1.8.1   US          3<br>
 8     8 2014-07-08   28216 3.0.2     x86_64 linux-gnu whisker      0.3-2   US          5<br>
 9     9 2014-07-08    5928 NA        NA     NA        Rcpp         0.10.4  CN          6<br>
10    10 2014-07-08 2206029 3.0.2     x86_64 linux-gnu hflights     0.1     US          7<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></int></p>
</blockquote>
<p>| You are doing so well!</p>
<p>|=================================                                               |  42%<br>
| The negative sign in front of time tells select() that we DON'T want the time column.<br>
| Now, let's combine strategies to omit all columns from X through size (X:size). To see<br>
| how this might work, let's look at a numerical example with -5:20.</p>
<blockquote>
<p>-5:20<br>
 [1] -5 -4 -3 -2 -1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</p>
</blockquote>
<p>| Your dedication is inspiring!</p>
<p>|===================================                                             |  43%<br>
| Oops! That gaves us a vector of numbers from -5 through 20, which is not what we want.<br>
| Instead, we want to negate the entire sequence of numbers from 5 through 20, so that we<br>
| get -5, -6, -7, ... , -18, -19, -20. Try the same thing, except surround 5:20 with<br>
| parentheses so that R knows we want it to first come up with the sequence of numbers,<br>
| then apply the negative sign to the whole thing.</p>
<blockquote>
<p>-(5:20)<br>
 [1]  -5  -6  -7  -8  -9 -10 -11 -12 -13 -14 -15 -16 -17 -18 -19 -20</p>
</blockquote>
<p>| You're the best!</p>
<p>|====================================                                            |  45%<br>
| Use this knowledge to omit all columns X:size using select().</p>
<blockquote>
<p>select(cran,-(X:size))<br>
# A tibble: 225,468 x 7<br>
   r_version r_arch r_os      package      version country ip_id<br><chr><chr><chr><chr><chr><chr><int><br>
 1 3.1.0     x86_64 mingw32   htmltools    0.2.4   US          1<br>
 2 3.1.0     x86_64 mingw32   tseries      0.10-32 US          2<br>
 3 3.1.0     x86_64 linux-gnu party        1.0-15  US          3<br>
 4 3.1.0     x86_64 linux-gnu Hmisc        3.14-4  US          3<br>
 5 3.0.2     x86_64 linux-gnu digest       0.6.4   CA          4<br>
 6 3.1.0     x86_64 linux-gnu randomForest 4.6-7   US          3<br>
 7 3.1.0     x86_64 linux-gnu plyr         1.8.1   US          3<br>
 8 3.0.2     x86_64 linux-gnu whisker      0.3-2   US          5<br>
 9 NA        NA     NA        Rcpp         0.10.4  CN          6<br>
10 3.0.2     x86_64 linux-gnu hflights     0.1     US          7<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></p>
</blockquote>
<p>| You got it right!</p>
<p>|=====================================                                           |  47%<br>
| Now that you know how to select a subset of columns using select(), a natural next<br>
| question is "How do I select a subset of rows?" That's where the filter() function<br>
| comes in.</p>
<p>...</p>
<p>|=======================================                                         |  48%<br>
| Use filter(cran, package == "swirl") to select all rows for which the package variable<br>
| is equal to "swirl". Be sure to use two equals signs side-by-side!</p>
<blockquote>
<p>filter(cran,package=="swirl")<br>
# A tibble: 820 x 11<br>
       X date      time      size r_version r_arch r_os      package version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1    27 2014-07-~ 00:17:~ 105350 3.0.2     x86_64 mingw32   swirl   2.2.9   US         20<br>
 2   156 2014-07-~ 00:22:~  41261 3.1.0     x86_64 linux-gnu swirl   2.2.9   US         66<br>
 3   358 2014-07-~ 00:13:~ 105335 2.15.2    x86_64 mingw32   swirl   2.2.9   CA        115<br>
 4   593 2014-07-~ 00:59:~ 105465 3.1.0     x86_64 darwin13~ swirl   2.2.9   MX        162<br>
 5   831 2014-07-~ 00:55:~ 105335 3.0.3     x86_64 mingw32   swirl   2.2.9   US         57<br>
 6   997 2014-07-~ 00:33:~  41261 3.1.0     x86_64 mingw32   swirl   2.2.9   US         70<br>
 7  1023 2014-07-~ 00:35:~ 106393 3.1.0     x86_64 mingw32   swirl   2.2.9   BR        248<br>
 8  1144 2014-07-~ 00:00:~ 106534 3.0.2     x86_64 linux-gnu swirl   2.2.9   US        261<br>
 9  1402 2014-07-~ 00:41:~  41261 3.1.0     i386   mingw32   swirl   2.2.9   US        234<br>
10  1424 2014-07-~ 00:44:~ 106393 3.1.0     x86_64 linux-gnu swirl   2.2.9   US        301<br>
# ... with 810 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| Great job!</p>
<p>|========================================                                        |  50%<br>
| Again, note that filter() recognizes 'package' as a column of cran, without you having<br>
| to explicitly specify cran$package.</p>
<p>...</p>
<p>|=========================================                                       |  52%<br>
| The == operator asks whether the thing on the left is equal to the thing on the right.<br>
| If yes, then it returns TRUE. If no, then FALSE. In this case, package is an entire<br>
| vector (column) of values, so package == "swirl" returns a vector of TRUEs and FALSEs.<br>
| filter() then returns only the rows of cran corresponding to the TRUEs.</p>
<p>...</p>
<p>|===========================================                                     |  53%<br>
| You can specify as many conditions as you want, separated by commas. For example<br>
| filter(cran, r_version == "3.1.1", country == "US") will return all rows of cran<br>
| corresponding to downloads from users in the US running R version 3.1.1. Try it out.</p>
<blockquote>
<p>filter(cran, r_version == "3.1.1", country == "US")<br>
# A tibble: 1,588 x 11<br>
       X date     time      size r_version r_arch r_os     package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1  2216 2014-07~ 00:48:~ 3.85e5 3.1.1     x86_64 darwin1~ colorspa~ 1.2-4   US        191<br>
 2 17332 2014-07~ 03:39:~ 1.97e5 3.1.1     x86_64 darwin1~ httr      0.3     US       1704<br>
 3 17465 2014-07~ 03:25:~ 2.33e4 3.1.1     x86_64 darwin1~ snow      0.3-13  US         62<br>
 4 18844 2014-07~ 03:59:~ 1.91e5 3.1.1     x86_64 darwin1~ maxLik    1.2-0   US       1533<br>
 5 30182 2014-07~ 04:13:~ 7.77e4 3.1.1     i386   mingw32  randomFo~ 4.6-7   US        646<br>
 6 30193 2014-07~ 04:06:~ 2.35e6 3.1.1     i386   mingw32  ggplot2   1.0.0   US          8<br>
 7 30195 2014-07~ 04:07:~ 2.99e5 3.1.1     i386   mingw32  fExtremes 3010.81 US       2010<br>
 8 30217 2014-07~ 04:32:~ 5.68e5 3.1.1     i386   mingw32  rJava     0.9-6   US         98<br>
 9 30245 2014-07~ 04:10:~ 5.27e5 3.1.1     i386   mingw32  LPCM      0.44-8  US          8<br>
10 30354 2014-07~ 04:32:~ 1.76e6 3.1.1     i386   mingw32  mgcv      1.8-1   US       2122<br>
# ... with 1,578 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| That's a job well done!</p>
<p>|============================================                                    |  55%<br>
| The conditions passed to filter() can make use of any of the standard comparison<br>
| operators. Pull up the relevant documentation with ?Comparison (that's an uppercase C).</p>
<blockquote>
<p>?Comparison</p>
</blockquote>
<p>| You are quite good my friend!</p>
<p>|=============================================                                   |  57%<br>
| Edit your previous call to filter() to instead return rows corresponding to users in<br>
| "IN" (India) running an R version that is less than or equal to "3.0.2". The up arrow<br>
| on your keyboard may come in handy here. Don't forget your double quotes!</p>
<blockquote>
<p>filter(cran, r_version &lt;= "3.0.2", country == "IN")<br>
# A tibble: 4,139 x 11<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1   348 2014-07~ 00:44:~  1.02e7 3.0.0     x86_64 mingw32 BH        1.54.0~ IN        112<br>
 2  9990 2014-07~ 02:11:~  3.97e5 3.0.2     x86_64 linux-~ equateIRT 1.1     IN       1054<br>
 3  9991 2014-07~ 02:11:~  1.19e5 3.0.2     x86_64 linux-~ ggdendro  0.1-14  IN       1054<br>
 4  9992 2014-07~ 02:11:~  8.18e4 3.0.2     x86_64 linux-~ dfcrm     0.2-2   IN       1054<br>
 5 10022 2014-07~ 02:19:~  1.56e6 2.15.0    x86_64 mingw32 RcppArma~ 0.4.32~ IN       1060<br>
 6 10023 2014-07~ 02:19:~  1.18e6 2.15.1    i686   linux-~ forecast  5.4     IN       1060<br>
 7 10189 2014-07~ 02:38:~  9.09e5 3.0.2     x86_64 linux-~ editrules 2.7.2   IN       1054<br>
 8 10199 2014-07~ 02:38:~  1.78e5 3.0.2     x86_64 linux-~ energy    1.6.1   IN       1054<br>
 9 10200 2014-07~ 02:38:~  5.18e4 3.0.2     x86_64 linux-~ ENmisc    1.2-7   IN       1054<br>
10 10201 2014-07~ 02:38:~  6.52e4 3.0.2     x86_64 linux-~ entropy   1.2.0   IN       1054<br>
# ... with 4,129 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| Excellent work!</p>
<p>|===============================================                                 |  58%<br>
| Our last two calls to filter() requested all rows for which some condition AND another<br>
| condition were TRUE. We can also request rows for which EITHER one condition OR another<br>
| condition are TRUE. For example, filter(cran, country == "US" | country == "IN") will<br>
| gives us all rows for which the country variable equals either "US" or "IN". Give it a<br>
| go.</p>
<blockquote>
<p>filter(cran, country == "US | country == "IN")<br>
Error: unexpected symbol in "filter(cran, country == "US | country == "IN"<br>
filter(cran, country == "US" | country == "IN")<br>
# A tibble: 95,283 x 11<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07~ 00:54:~   80589 3.1.0     x86_64 mingw32 htmltools 0.2.4   US          1<br>
 2     2 2014-07~ 00:59:~  321767 3.1.0     x86_64 mingw32 tseries   0.10-32 US          2<br>
 3     3 2014-07~ 00:47:~  748063 3.1.0     x86_64 linux-~ party     1.0-15  US          3<br>
 4     4 2014-07~ 00:48:~  606104 3.1.0     x86_64 linux-~ Hmisc     3.14-4  US          3<br>
 5     6 2014-07~ 00:48:~   77681 3.1.0     x86_64 linux-~ randomFo~ 4.6-7   US          3<br>
 6     7 2014-07~ 00:48:~  393754 3.1.0     x86_64 linux-~ plyr      1.8.1   US          3<br>
 7     8 2014-07~ 00:47:~   28216 3.0.2     x86_64 linux-~ whisker   0.3-2   US          5<br>
 8    10 2014-07~ 00:15:~ 2206029 3.0.2     x86_64 linux-~ hflights  0.1     US          7<br>
 9    11 2014-07~ 00:15:~  526858 3.0.2     x86_64 linux-~ LPCM      0.44-8  US          8<br>
10    12 2014-07~ 00:14:~ 2351969 2.14.1    x86_64 linux-~ ggplot2   1.0.0   US          8<br>
# ... with 95,273 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| Your dedication is inspiring!</p>
<p>|================================================                                |  60%<br>
| Now, use filter() to fetch all rows for which size is strictly greater than (&gt;) 100500<br>
| (no quotes, since size is numeric) AND r_os equals "linux-gnu". Hint: You are passing<br>
| three arguments to filter(): the name of the dataset, the first condition, and the<br>
| second condition.</p>
<blockquote>
<p>filter(cran,size&gt;100500,r_os=="linux-gnu")<br>
# A tibble: 33,683 x 11<br>
       X date      time        size r_version r_arch r_os    package version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     3 2014-07-~ 00:47:13  748063 3.1.0     x86_64 linux-~ party   1.0-15  US          3<br>
 2     4 2014-07-~ 00:48:05  606104 3.1.0     x86_64 linux-~ Hmisc   3.14-4  US          3<br>
 3     7 2014-07-~ 00:48:35  393754 3.1.0     x86_64 linux-~ plyr    1.8.1   US          3<br>
 4    10 2014-07-~ 00:15:35 2206029 3.0.2     x86_64 linux-~ hfligh~ 0.1     US          7<br>
 5    11 2014-07-~ 00:15:25  526858 3.0.2     x86_64 linux-~ LPCM    0.44-8  US          8<br>
 6    12 2014-07-~ 00:14:45 2351969 2.14.1    x86_64 linux-~ ggplot2 1.0.0   US          8<br>
 7    14 2014-07-~ 00:15:35 3097729 3.0.2     x86_64 linux-~ Rcpp    0.9.7   VE         10<br>
 8    15 2014-07-~ 00:14:37  568036 3.1.0     x86_64 linux-~ rJava   0.9-6   US         11<br>
 9    16 2014-07-~ 00:15:50 1600441 3.1.0     x86_64 linux-~ RSQLite 0.11.4  US          7<br>
10    18 2014-07-~ 00:26:59  186685 3.1.0     x86_64 linux-~ ipred   0.9-3   DE         13<br>
# ... with 33,673 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| You're the best!</p>
<p>|=================================================                               |  62%<br>
| Finally, we want to get only the rows for which the r_version is not missing. R<br>
| represents missing values with NA and these missing values can be detected using the<br>
| is.na() function.</p>
<p>...</p>
<p>|===================================================                             |  63%<br>
| To see how this works, try is.na(c(3, 5, NA, 10)).</p>
<blockquote>
<p>is.na(c(3,5,NA,10))<br>
[1] FALSE FALSE  TRUE FALSE</p>
</blockquote>
<p>| All that hard work is paying off!</p>
<p>|====================================================                            |  65%<br>
| Now, put an exclamation point (!) before is.na() to change all of the TRUEs to FALSEs<br>
| and all of the FALSEs to TRUEs, thus telling us what is NOT NA: !is.na(c(3, 5, NA,<br>
| 10)).</p>
<blockquote>
<p>!is.na(c(3,5,NA,10))<br>
[1]  TRUE  TRUE FALSE  TRUE</p>
</blockquote>
<p>| Keep up the great work!</p>
<p>|=====================================================                           |  67%<br>
| Okay, ready to put all of this together? Use filter() to return all rows of cran for<br>
| which r_version is NOT NA. Hint: You will need to use !is.na() as part of your second<br>
| argument to filter().</p>
<blockquote>
<p>filter(cran,!is.na(r_version))<br>
# A tibble: 207,205 x 11<br>
       X date     time       size r_version r_arch r_os    package   version country ip_id<br><int><chr><chr><int><chr><chr><chr><chr><chr><chr><int><br>
 1     1 2014-07~ 00:54:~   80589 3.1.0     x86_64 mingw32 htmltools 0.2.4   US          1<br>
 2     2 2014-07~ 00:59:~  321767 3.1.0     x86_64 mingw32 tseries   0.10-32 US          2<br>
 3     3 2014-07~ 00:47:~  748063 3.1.0     x86_64 linux-~ party     1.0-15  US          3<br>
 4     4 2014-07~ 00:48:~  606104 3.1.0     x86_64 linux-~ Hmisc     3.14-4  US          3<br>
 5     5 2014-07~ 00:46:~   79825 3.0.2     x86_64 linux-~ digest    0.6.4   CA          4<br>
 6     6 2014-07~ 00:48:~   77681 3.1.0     x86_64 linux-~ randomFo~ 4.6-7   US          3<br>
 7     7 2014-07~ 00:48:~  393754 3.1.0     x86_64 linux-~ plyr      1.8.1   US          3<br>
 8     8 2014-07~ 00:47:~   28216 3.0.2     x86_64 linux-~ whisker   0.3-2   US          5<br>
 9    10 2014-07~ 00:15:~ 2206029 3.0.2     x86_64 linux-~ hflights  0.1     US          7<br>
10    11 2014-07~ 00:15:~  526858 3.0.2     x86_64 linux-~ LPCM      0.44-8  US          8<br>
# ... with 207,195 more rows</int></chr></chr></chr></chr></chr></chr></int></chr></chr></int></p>
</blockquote>
<p>| All that practice is paying off!</p>
<p>|=======================================================                         |  68%<br>
| We've seen how to select a subset of columns and rows from our dataset using select()<br>
| and filter(), respectively. Inherent in select() was also the ability to arrange our<br>
| selected columns in any order we please.</p>
<p>...</p>
<p>|========================================================                        |  70%<br>
| Sometimes we want to order the rows of a dataset according to the values of a<br>
| particular variable. This is the job of arrange().</p>
<p>...</p>
<p>|=========================================================                       |  72%<br>
| To see how arrange() works, let's first take a subset of cran. select() all columns<br>
| from size through ip_id and store the result in cran2.</p>
<blockquote>
<p>cran2&lt;-select(cran,size:ip_id)</p>
</blockquote>
<p>| Excellent work!</p>
<p>|===========================================================                     |  73%<br>
| Now, to order the ROWS of cran2 so that ip_id is in ascending order (from small to<br>
| large), type arrange(cran2, ip_id). You may want to make your console wide enough so<br>
| that you can see ip_id, which is the last column.</p>
<blockquote>
<p>arrange(cran2,ip_id)<br>
# A tibble: 225,468 x 8<br>
     size r_version r_arch r_os         package     version country ip_id<br><int><chr><chr><chr><chr><chr><chr><int><br>
 1  80589 3.1.0     x86_64 mingw32      htmltools   0.2.4   US          1<br>
 2 180562 3.0.2     x86_64 mingw32      yaml        2.1.13  US          1<br>
 3 190120 3.1.0     i386   mingw32      babel       0.2-6   US          1<br>
 4 321767 3.1.0     x86_64 mingw32      tseries     0.10-32 US          2<br>
 5  52281 3.0.3     x86_64 darwin10.8.0 quadprog    1.5-5   US          2<br>
 6 876702 3.1.0     x86_64 linux-gnu    zoo         1.7-11  US          2<br>
 7 321764 3.0.2     x86_64 linux-gnu    tseries     0.10-32 US          2<br>
 8 876702 3.1.0     x86_64 linux-gnu    zoo         1.7-11  US          2<br>
 9 321768 3.1.0     x86_64 mingw32      tseries     0.10-32 US          2<br>
10 784093 3.1.0     x86_64 linux-gnu    strucchange 1.5-0   US          2<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></p>
</blockquote>
<p>| Perseverance, that's the answer.</p>
<p>|============================================================                    |  75%<br>
| To do the same, but in descending order, change the second argument to desc(ip_id),<br>
| where desc() stands for 'descending'. Go ahead.</p>
<blockquote>
<p>arrange(cran2,desc(ip_id))<br>
# A tibble: 225,468 x 8<br>
      size r_version r_arch r_os         package      version country ip_id<br><int><chr><chr><chr><chr><chr><chr><int><br>
 1    5933 NA        NA     NA           CPE          1.4.2   CN      13859<br>
 2  569241 3.1.0     x86_64 mingw32      multcompView 0.1-5   US      13858<br>
 3  228444 3.1.0     x86_64 mingw32      tourr        0.5.3   NZ      13857<br>
 4  308962 3.1.0     x86_64 darwin13.1.0 ctv          0.7-9   CN      13856<br>
 5  950964 3.0.3     i386   mingw32      knitr        1.6     CA      13855<br>
 6   80185 3.0.3     i386   mingw32      htmltools    0.2.4   CA      13855<br>
 7 1431750 3.0.3     i386   mingw32      shiny        0.10.0  CA      13855<br>
 8 2189695 3.1.0     x86_64 mingw32      RMySQL       0.9-3   US      13854<br>
 9 4818024 3.1.0     i386   mingw32      igraph       0.7.1   US      13853<br>
10  197495 3.1.0     x86_64 mingw32      coda         0.16-1  US      13852<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></p>
</blockquote>
<p>| You're the best!</p>
<p>|=============================================================                   |  77%<br>
| We can also arrange the data according to the values of multiple variables. For<br>
| example, arrange(cran2, package, ip_id) will first arrange by package names (ascending<br>
| alphabetically), then by ip_id. This means that if there are multiple rows with the<br>
| same value for package, they will be sorted by ip_id (ascending numerically). Try<br>
| arrange(cran2, package, ip_id) now.</p>
<blockquote>
<p>arrange(cran2,package,ip_id)<br>
# A tibble: 225,468 x 8<br>
    size r_version r_arch r_os         package version country ip_id<br><int><chr><chr><chr><chr><chr><chr><int><br>
 1 71677 3.0.3     x86_64 darwin10.8.0 A3      0.9.2   CN       1003<br>
 2 71672 3.1.0     x86_64 linux-gnu    A3      0.9.2   US       1015<br>
 3 71677 3.1.0     x86_64 mingw32      A3      0.9.2   IN       1054<br>
 4 70438 3.0.1     x86_64 darwin10.8.0 A3      0.9.2   CN       1513<br>
 5 71677 NA        NA     NA           A3      0.9.2   BR       1526<br>
 6 71892 3.0.2     x86_64 linux-gnu    A3      0.9.2   IN       1542<br>
 7 71677 3.1.0     x86_64 linux-gnu    A3      0.9.2   ZA       2925<br>
 8 71672 3.1.0     x86_64 mingw32      A3      0.9.2   IL       3889<br>
 9 71677 3.0.3     x86_64 mingw32      A3      0.9.2   DE       3917<br>
10 71672 3.1.0     x86_64 mingw32      A3      0.9.2   US       4219<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></p>
</blockquote>
<p>| You got it!</p>
<p>|===============================================================                 |  78%<br>
| Arrange cran2 by the following three variables, in this order: country (ascending),<br>
| r_version (descending), and ip_id (ascending).</p>
<blockquote>
<p>arrange(cran2,country,desc(r_version),ip_id)<br>
# A tibble: 225,468 x 8<br>
      size r_version r_arch r_os      package       version   country ip_id<br><int><chr><chr><chr><chr><chr><chr><int><br>
 1 1556858 3.1.1     i386   mingw32   RcppArmadillo 0.4.320.0 A1       2843<br>
 2 1823512 3.1.0     x86_64 linux-gnu mgcv          1.8-1     A1       2843<br>
 3   15732 3.1.0     i686   linux-gnu grnn          0.1.0     A1       3146<br>
 4 3014840 3.1.0     x86_64 mingw32   Rcpp          0.11.2    A1       3146<br>
 5  660087 3.1.0     i386   mingw32   xts           0.9-7     A1       3146<br>
 6  522261 3.1.0     i386   mingw32   FNN           1.1       A1       3146<br>
 7  522263 3.1.0     i386   mingw32   FNN           1.1       A1       3146<br>
 8 1676627 3.1.0     x86_64 linux-gnu rgeos         0.3-5     A1       3146<br>
 9 2118530 3.1.0     x86_64 linux-gnu spacetime     1.1-0     A1       3146<br>
10 2217180 3.1.0     x86_64 mingw32   gstat         1.0-19    A1       3146<br>
# ... with 225,458 more rows</int></chr></chr></chr></chr></chr></chr></int></p>
</blockquote>
<p>| All that practice is paying off!</p>
<p>|================================================================                |  80%<br>
| To illustrate the next major function in dplyr, let's take another subset of our<br>
| original data. Use select() to grab 3 columns from cran -- ip_id, package, and size (in<br>
| that order) -- and store the result in a new variable called cran3.</p>
<blockquote>
<p>cran3&lt;-select(cran,ip_is,package,size)<br>
Error: Can't subset columns that don't exist.<br>
x The column <code>ip_is</code> doesn't exist.<br>
Run <code>rlang::last_error()</code> to see where the error occurred.<br>
cran3&lt;-select(cran,ip_id,package,size)</p>
</blockquote>
<p>| You are really on a roll!</p>
<p>|=================================================================               |  82%<br>
| Take a look at cran3 now.</p>
<blockquote>
<p>cran3<br>
# A tibble: 225,468 x 3<br>
   ip_id package         size<br><int><chr><int><br>
 1     1 htmltools      80589<br>
 2     2 tseries       321767<br>
 3     3 party         748063<br>
 4     3 Hmisc         606104<br>
 5     4 digest         79825<br>
 6     3 randomForest   77681<br>
 7     3 plyr          393754<br>
 8     5 whisker        28216<br>
 9     6 Rcpp            5928<br>
10     7 hflights     2206029<br>
# ... with 225,458 more rows</int></chr></int></p>
</blockquote>
<p>| Your dedication is inspiring!</p>
<p>|===================================================================             |  83%<br>
| It's common to create a new variable based on the value of one or more variables<br>
| already in a dataset. The mutate() function does exactly this.</p>
<p>...</p>
<p>|====================================================================            |  85%<br>
| The size variable represents the download size in bytes, which are units of computer<br>
| memory. These days, megabytes (MB) are a more common unit of measurement. One megabyte<br>
| is equal to 2^20 bytes. That's 2 to the power of 20, which is approximately one million<br>
| bytes!</p>
<p>...</p>
<p>|=====================================================================           |  87%<br>
| We want to add a column called size_mb that contains the download size in megabytes.<br>
| Here's the code to do it:<br>
|<br>
| mutate(cran3, size_mb = size / 2^20)</p>
<blockquote>
<p>mutate(cran3, size_mb = size / 2^20)<br>
# A tibble: 225,468 x 4<br>
   ip_id package         size size_mb<br><int><chr><int><dbl><br>
 1     1 htmltools      80589 0.0769<br>
 2     2 tseries       321767 0.307<br>
 3     3 party         748063 0.713<br>
 4     3 Hmisc         606104 0.578<br>
 5     4 digest         79825 0.0761<br>
 6     3 randomForest   77681 0.0741<br>
 7     3 plyr          393754 0.376<br>
 8     5 whisker        28216 0.0269<br>
 9     6 Rcpp            5928 0.00565<br>
10     7 hflights     2206029 2.10<br>
# ... with 225,458 more rows</dbl></int></chr></int></p>
</blockquote>
<p>| You are really on a roll!</p>
<p>|=======================================================================         |  88%<br>
| An even larger unit of memory is a gigabyte (GB), which equals 2^10 megabytes. We might<br>
| as well add another column for download size in gigabytes!</p>
<p>...</p>
<p>|========================================================================        |  90%<br>
| One very nice feature of mutate() is that you can use the value computed for your<br>
| second column (size_mb) to create a third column, all in the same line of code. To see<br>
| this in action, repeat the exact same command as above, except add a third argument<br>
| creating a column that is named size_gb and equal to size_mb / 2^10.</p>
<blockquote>
<p>mutate(cran3, size_mb = size / 2^20, size_gb = size_mb / 2^10)<br>
# A tibble: 225,468 x 5<br>
   ip_id package         size size_mb    size_gb<br><int><chr><int><dbl><dbl><br>
 1     1 htmltools      80589 0.0769  0.0000751<br>
 2     2 tseries       321767 0.307   0.000300<br>
 3     3 party         748063 0.713   0.000697<br>
 4     3 Hmisc         606104 0.578   0.000564<br>
 5     4 digest         79825 0.0761  0.0000743<br>
 6     3 randomForest   77681 0.0741  0.0000723<br>
 7     3 plyr          393754 0.376   0.000367<br>
 8     5 whisker        28216 0.0269  0.0000263<br>
 9     6 Rcpp            5928 0.00565 0.00000552<br>
10     7 hflights     2206029 2.10    0.00205<br>
# ... with 225,458 more rows</dbl></dbl></int></chr></int></p>
</blockquote>
<p>| That's correct!</p>
<p>|=========================================================================       |  92%<br>
| Let's try one more for practice. Pretend we discovered a glitch in the system that<br>
| provided the original values for the size variable. All of the values in cran3 are 1000<br>
| bytes less than they should be. Using cran3, create just one new column called<br>
| correct_size that contains the correct size.</p>
<blockquote>
<p><br>
mutate(cran3, correct_size=size+1000)<br>
# A tibble: 225,468 x 4<br>
   ip_id package         size correct_size<br><int><chr><int><dbl><br>
 1     1 htmltools      80589        81589<br>
 2     2 tseries       321767       322767<br>
 3     3 party         748063       749063<br>
 4     3 Hmisc         606104       607104<br>
 5     4 digest         79825        80825<br>
 6     3 randomForest   77681        78681<br>
 7     3 plyr          393754       394754<br>
 8     5 whisker        28216        29216<br>
 9     6 Rcpp            5928         6928<br>
10     7 hflights     2206029      2207029<br>
# ... with 225,458 more rows</dbl></int></chr></int></p>
</blockquote>
<p>| You're the best!</p>
<p>|===========================================================================     |  93%<br>
| The last of the five core dplyr verbs, summarize(), collapses the dataset to a single<br>
| row. Let's say we're interested in knowing the average download size. summarize(cran,<br>
| avg_bytes = mean(size)) will yield the mean value of the size variable. Here we've<br>
| chosen to label the result 'avg_bytes', but we could have named it anything. Give it a<br>
| try.</p>
<blockquote>
<p>summarize(cran,avg_bytes=mean(size))<br>
# A tibble: 1 x 1<br>
  avg_bytes<br><dbl><br>
1   844086.</dbl></p>
</blockquote>
<p>| You are doing so well!</p>
<p>|============================================================================    |  95%<br>
| That's not particularly interesting. summarize() is most useful when working with data<br>
| that has been grouped by the values of a particular variable.</p>
<p>...</p>
<p>|=============================================================================   |  97%<br>
| We'll look at grouped data in the next lesson, but the idea is that summarize() can<br>
| give you the requested value FOR EACH group in your dataset.</p>
<p>...</p>
<p>|=============================================================================== |  98%<br>
| In this lesson, you learned how to manipulate data using dplyr's five main functions.<br>
| In the next lesson, we'll look at how to take advantage of some other useful features<br>
| of dplyr to make your life as a data analyst much easier.</p>
<p>...</p>
<p>|================================================================================| 100%<br>
| Would you like to receive credit for completing this course on Coursera.org?</p>
<p>1: No<br>
2: Yes</p>
<p>Selection: 2<br>
What is your email address? xxxxxx@xxxxxxxxxxxx<br>
What is your assignment token? xXxXxxXXxXxxXXXx<br>
Grade submission succeeded!</p>
<p>| You are really on a roll!</p>
<p>| You've reached the end of this lesson! Returning to the main menu...</p>
<p>| Please choose a course, or type 0 to exit swirl.</p>
<p>1: Getting and Cleaning Data<br>
2: R Programming<br>
3: Take me to the swirl course repository!</p>
<p>Selection: 0</p>
<p>| Leaving swirl now. Type swirl() to resume.</p>
<blockquote>
<p>ls()<br>
[1] "cran"     "cran2"    "cran3"    "path2csv"<br>
rm(list=ls())</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Last updated 2020-04-23 20:35:34.926750 IST</em></p>

</div>
</div>
</div>
</div>
    </div>
    </article><article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title"><a href="00502/" class="u-url">Air Pollution data</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                Krishnakanth Allika
            </span></p>
            <p class="dateline">
            <a href="00502/" rel="bookmark">
            <time class="published dt-published" datetime="2020-04-17T18:02:38+05:30" itemprop="datePublished" title="2020-04-17 18:02">2020-04-17 18:02</time></a>
            </p>
                <p class="commentline">
        
<a href="%7Blink%7D" onclick="this.href='/posts/00502/'; this.target='_self';"><span class="IDCommentsReplace" style="display:none">cache/posts/00502_Air_pollution.html</span>
<script>
var idcomments_acct = '7fae5836cfdd49cac599cac5b95695d1';
var idcomments_post_id = "cache/posts/00502_Air_pollution.html";
var idcomments_post_url = "/posts/00502/";
</script><script src="https://www.intensedebate.com/js/genericLinkWrapperV2.js"></script></a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Contents</strong> <a name="contents"></a></p>
<ol>
<li><a href="00502/#intro">Introduction</a></li>
<li><a href="00502/#f1">Function 1: Mean, Median, Mode, Standard Deviation</a></li>
<li><a href="00502/#f2">Function 2: Data Quality</a></li>
<li><a href="00502/#f3">Function 3: Correlation Test</a></li>
</ol>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Introduction-">Introduction <a name="intro"></a><a class="anchor-link" href="00502/#Introduction-">¶</a>
</h3>
<p><strong>Data</strong><br>
The zip file containing the data can be downloaded here:</p>
<p><a href="http://link.datascience.eu.org/p004d1">AirPollution.zip</a> (2.67MB)</p>
<p>The zip file contains 332 comma-separated-value (CSV) files containing pollution monitoring data for fine particulate matter (PM) air pollution at 332 locations in the United States. Each file contains data from a single monitor and the ID number for each monitor is contained in the file name. For example, data for monitor 200 is contained in the file "200.csv". Each file contains three variables:</p>
<p>Date: the date of the observation in YYYY-MM-DD format (year-month-day)<br>
sulfate: the level of sulfate PM in the air on that date (measured in micrograms per cubic meter)<br>
nitrate: the level of nitrate PM in the air on that date (measured in micrograms per cubic meter)</p>
<p>This data will be used in the following functions. The goal is load data from these files without dowloading or storing them in the hard disk drive, but be available to the functions to woek on them.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Create an empty file in memory</span>
<span class="n">file</span><span class="o">&lt;-</span><span class="nf">tempfile</span><span class="p">()</span>
<span class="c1"># Download the zip file to this empty file</span>
<span class="nf">download.file</span><span class="p">(</span><span class="s">"http://link.datascience.eu.org/p004d1"</span><span class="p">,</span><span class="n">file</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">"wb"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Check data file format</span>
<span class="nf">head</span><span class="p">(</span><span class="nf">unzip</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="n">list</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr>
<th scope="col">Name</th>
<th scope="col">Length</th>
<th scope="col">Date</th>
</tr></thead>
<tbody>
<tr>
<td>data/              </td>
<td>    0              </td>
<td>2012-09-22 00:27:00</td>
</tr>
<tr>
<td>data/001.csv       </td>
<td>31271              </td>
<td>2012-09-22 01:30:00</td>
</tr>
<tr>
<td>data/002.csv       </td>
<td>81435              </td>
<td>2012-09-22 01:30:00</td>
</tr>
<tr>
<td>data/003.csv       </td>
<td>47185              </td>
<td>2012-09-22 01:30:00</td>
</tr>
<tr>
<td>data/004.csv       </td>
<td>78887              </td>
<td>2012-09-22 01:30:00</td>
</tr>
<tr>
<td>data/005.csv       </td>
<td>63204              </td>
<td>2012-09-22 01:30:00</td>
</tr>
</tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>[<a href="00502/#contents">^top</a>]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Function-1:-Mean,-Median,-Mode,-Standard-Deviation-">Function 1: Mean, Median, Mode, Standard Deviation <a name="f1"></a><a class="anchor-link" href="00502/#Function-1:-Mean,-Median,-Mode,-Standard-Deviation-">¶</a>
</h3>
<p>The function "PollutantStats" will calculate the mean, median, mode and standard deviation of a pollutant (sulfate or nitrate) across a specified list of monitors.</p>
<p><strong>Input</strong><br>
The function "PollutantStats" accepts two arguments:</p>
<ol>
<li>"pollutant" - Pollutant name <em>sulfate</em> or <em>nitrate</em> </li>
<li>"id" - An <strong>optional</strong> Monitor id vector. Default value is 1:332.</li>
</ol>
<p><strong>Output</strong><br>
Mean, median, mode and standard deviation of the pollutant.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">PollutantStats</span><span class="o">&lt;-</span><span class="nf">function</span><span class="p">(</span><span class="n">pollutant</span><span class="p">,</span><span class="n">id</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">332</span><span class="p">){</span>
    <span class="c1"># Initialize empty vectors.</span>
    <span class="n">p</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">()</span>    <span class="c1"># Pollutant vector</span>
    <span class="c1"># Loop through each file number.</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="n">id</span><span class="p">){</span>
        <span class="c1"># We need to have the file path in "data/001.csv" format to use read.csv() function.</span>
        <span class="c1"># Use sprintf to combine directory name and file number in required format.</span>
        <span class="n">df</span><span class="o">&lt;-</span><span class="nf">read.csv</span><span class="p">(</span><span class="nf">unz</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">"data/%03d.csv"</span><span class="p">,</span><span class="n">i</span><span class="p">)))</span>
        <span class="c1"># Using a comma in df[,pollutant] converts it into a numeric vector.</span>
        <span class="c1"># Else it remains a dataframe and pollutant_vector becomes a list.</span>
        <span class="n">p</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">df</span><span class="p">[,</span><span class="n">pollutant</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="c1"># Calculate mean, median, mode and SD excluding missing values.</span>
    <span class="n">Mean</span><span class="o">&lt;-</span><span class="nf">mean</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
    <span class="n">Median</span><span class="o">&lt;-</span><span class="nf">mean</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
    <span class="n">Mode</span><span class="o">&lt;-</span><span class="nf">names</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">p</span><span class="p">))[</span><span class="nf">table</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">==</span><span class="nf">max</span><span class="p">(</span><span class="nf">table</span><span class="p">(</span><span class="n">p</span><span class="p">))]</span>
    <span class="n">SD</span><span class="o">&lt;-</span><span class="nf">sd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">na.rm</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span>
    <span class="nf">data.frame</span><span class="p">(</span><span class="n">Pollutant</span><span class="o">=</span><span class="n">pollutant</span><span class="p">,</span><span class="n">Mean</span><span class="o">=</span><span class="n">Mean</span><span class="p">,</span><span class="n">Median</span><span class="o">=</span><span class="n">Median</span><span class="p">,</span><span class="n">Mode</span><span class="o">=</span><span class="n">Mode</span><span class="p">,</span><span class="n">Std_dev</span><span class="o">=</span><span class="n">SD</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">PollutantStats</span><span class="p">(</span><span class="s">"sulfate"</span><span class="p">,</span><span class="m">1</span><span class="o">:</span><span class="m">12</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr>
<th scope="col">Pollutant</th>
<th scope="col">Mean</th>
<th scope="col">Median</th>
<th scope="col">Mode</th>
<th scope="col">Std_dev</th>
</tr></thead>
<tbody><tr>
<td>sulfate </td>
<td>3.765641</td>
<td>3.765641</td>
<td>2.84    </td>
<td>2.874151</td>
</tr></tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">PollutantStats</span><span class="p">(</span><span class="s">"nitrate"</span><span class="p">,</span><span class="m">74</span><span class="o">:</span><span class="m">80</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr>
<th scope="col">Pollutant</th>
<th scope="col">Mean</th>
<th scope="col">Median</th>
<th scope="col">Mode</th>
<th scope="col">Std_dev</th>
</tr></thead>
<tbody><tr>
<td>nitrate </td>
<td>2.611021</td>
<td>2.611021</td>
<td>1.24    </td>
<td>2.802195</td>
</tr></tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">PollutantStats</span><span class="p">(</span><span class="s">"sulfate"</span><span class="p">,</span><span class="m">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr>
<th scope="col">Pollutant</th>
<th scope="col">Mean</th>
<th scope="col">Median</th>
<th scope="col">Mode</th>
<th scope="col">Std_dev</th>
</tr></thead>
<tbody><tr>
<td>sulfate  </td>
<td>0.6243649</td>
<td>0.6243649</td>
<td>0.349    </td>
<td>0.3637092</td>
</tr></tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">PollutantStats</span><span class="p">(</span><span class="s">"nitrate"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr>
<th scope="col">Pollutant</th>
<th scope="col">Mean</th>
<th scope="col">Median</th>
<th scope="col">Mode</th>
<th scope="col">Std_dev</th>
</tr></thead>
<tbody><tr>
<td>nitrate </td>
<td>1.702932</td>
<td>1.702932</td>
<td>1.1     </td>
<td>2.52504 </td>
</tr></tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>[<a href="00502/#contents">^top</a>]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Function-2:-Data-Quality-">Function 2: Data Quality <a name="f2"></a><a class="anchor-link" href="00502/#Function-2:-Data-Quality-">¶</a>
</h3>
<p>The function "DataQuality" will report the quality of data for each monitor ID.</p>
<p><strong>Input</strong><br>
The function accepts one argument:</p>
<ol>
<li>"id" - An <strong>optional</strong> Monitor id vector. Default value is 1:332.</li>
</ol>
<p><strong>Output</strong></p>
<ol>
<li>id: Monitor ID</li>
<li>Obs: Total number of valid and invalid observations for the corresponding monitor ID (including missing values)</li>
<li>Sulfate, Nitrate: Number of valid data points of each pollutant.</li>
<li>SulfateQ, NitrateQ: Percentage of valid data points of each pollutant.</li>
<li>PairWise: Number of valid data points of both pollutants together.</li>
<li>PairWiseQ: Percentafe of valid data points of both pollutants together</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">DataQuality</span><span class="o">&lt;-</span><span class="nf">function</span><span class="p">(</span><span class="n">id</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">332</span><span class="p">){</span>
    <span class="n">p</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="s">"sulfate"</span><span class="p">,</span><span class="s">"nitrate"</span><span class="p">)</span>
    <span class="c1"># Create an empty data frame</span>
    <span class="n">x</span><span class="o">=</span><span class="nf">integer</span><span class="p">()</span>
    <span class="n">q</span><span class="o">&lt;-</span><span class="nf">data.frame</span><span class="p">(</span><span class="n">id</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">Obs</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">Sulfate</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">Nitrate</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">PairWise</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="n">id</span><span class="p">){</span>
        <span class="c1"># Reading each csv file into a dataframe.</span>
        <span class="n">df</span><span class="o">&lt;-</span><span class="nf">read.csv</span><span class="p">(</span><span class="nf">unz</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">"data/%03d.csv"</span><span class="p">,</span><span class="n">i</span><span class="p">)))</span>
        <span class="n">obs</span><span class="o">&lt;-</span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
        <span class="n">sulfate</span><span class="o">&lt;-</span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="o">!</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="m">1</span><span class="p">]])),])</span>
        <span class="n">nitrate</span><span class="o">&lt;-</span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="o">!</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="m">2</span><span class="p">]])),])</span>
        <span class="n">pairwise</span><span class="o">&lt;-</span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="o">!</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="m">1</span><span class="p">]])</span><span class="o">|</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="m">2</span><span class="p">]])),])</span>
        <span class="n">q</span><span class="p">[</span><span class="nf">nrow</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="m">+1</span><span class="p">,]</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">obs</span><span class="p">,</span><span class="n">sulfate</span><span class="p">,</span><span class="n">nitrate</span><span class="p">,</span><span class="n">pairwise</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="c1"># Add SulfateQ, NitrateQ and PairWiseQ columns.</span>
    <span class="n">q</span><span class="o">$</span><span class="n">SulfateQ</span><span class="o">&lt;-</span><span class="nf">round</span><span class="p">(</span><span class="n">q</span><span class="o">$</span><span class="n">Sulfate</span><span class="o">/</span><span class="n">q</span><span class="o">$</span><span class="n">Obs</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
    <span class="n">q</span><span class="o">$</span><span class="n">NitrateQ</span><span class="o">&lt;-</span><span class="nf">round</span><span class="p">(</span><span class="n">q</span><span class="o">$</span><span class="n">Nitrate</span><span class="o">/</span><span class="n">q</span><span class="o">$</span><span class="n">Obs</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
    <span class="n">q</span><span class="o">$</span><span class="n">PairWiseQ</span><span class="o">&lt;-</span><span class="nf">round</span><span class="p">(</span><span class="n">q</span><span class="o">$</span><span class="n">PairWise</span><span class="o">/</span><span class="n">q</span><span class="o">$</span><span class="n">Obs</span><span class="o">*</span><span class="m">100</span><span class="p">,</span><span class="m">1</span><span class="p">)</span>
    <span class="n">q</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">DataQuality</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr>
<th scope="col">id</th>
<th scope="col">Obs</th>
<th scope="col">Sulfate</th>
<th scope="col">Nitrate</th>
<th scope="col">PairWise</th>
<th scope="col">SulfateQ</th>
<th scope="col">NitrateQ</th>
<th scope="col">PairWiseQ</th>
</tr></thead>
<tbody><tr>
<td>1   </td>
<td>1461</td>
<td>117 </td>
<td>122 </td>
<td>117 </td>
<td>8   </td>
<td>8.4 </td>
<td>8   </td>
</tr></tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">DataQuality</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">15</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr>
<th scope="col">id</th>
<th scope="col">Obs</th>
<th scope="col">Sulfate</th>
<th scope="col">Nitrate</th>
<th scope="col">PairWise</th>
<th scope="col">SulfateQ</th>
<th scope="col">NitrateQ</th>
<th scope="col">PairWiseQ</th>
</tr></thead>
<tbody>
<tr>
<td> 5  </td>
<td>2922</td>
<td>402 </td>
<td>405 </td>
<td>402 </td>
<td>13.8</td>
<td>13.9</td>
<td>13.8</td>
</tr>
<tr>
<td>10  </td>
<td>1096</td>
<td>148 </td>
<td>183 </td>
<td>148 </td>
<td>13.5</td>
<td>16.7</td>
<td>13.5</td>
</tr>
<tr>
<td>15  </td>
<td> 730</td>
<td> 83 </td>
<td> 85 </td>
<td> 83 </td>
<td>11.4</td>
<td>11.6</td>
<td>11.4</td>
</tr>
<tr>
<td>20  </td>
<td>1461</td>
<td>124 </td>
<td>128 </td>
<td>124 </td>
<td> 8.5</td>
<td> 8.8</td>
<td> 8.5</td>
</tr>
<tr>
<td>15  </td>
<td> 730</td>
<td> 83 </td>
<td> 85 </td>
<td> 83 </td>
<td>11.4</td>
<td>11.6</td>
<td>11.4</td>
</tr>
</tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">DataQuality</span><span class="p">(</span><span class="m">44</span><span class="o">:</span><span class="m">40</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr>
<th scope="col">id</th>
<th scope="col">Obs</th>
<th scope="col">Sulfate</th>
<th scope="col">Nitrate</th>
<th scope="col">PairWise</th>
<th scope="col">SulfateQ</th>
<th scope="col">NitrateQ</th>
<th scope="col">PairWiseQ</th>
</tr></thead>
<tbody>
<tr>
<td>44  </td>
<td>2557</td>
<td>283 </td>
<td>287 </td>
<td>283 </td>
<td>11.1</td>
<td>11.2</td>
<td>11.1</td>
</tr>
<tr>
<td>43  </td>
<td>1095</td>
<td> 74 </td>
<td> 77 </td>
<td> 74 </td>
<td> 6.8</td>
<td> 7.0</td>
<td> 6.8</td>
</tr>
<tr>
<td>42  </td>
<td>1095</td>
<td> 60 </td>
<td> 68 </td>
<td> 60 </td>
<td> 5.5</td>
<td> 6.2</td>
<td> 5.5</td>
</tr>
<tr>
<td>41  </td>
<td>2556</td>
<td>227 </td>
<td>243 </td>
<td>227 </td>
<td> 8.9</td>
<td> 9.5</td>
<td> 8.9</td>
</tr>
<tr>
<td>40  </td>
<td> 365</td>
<td> 21 </td>
<td> 21 </td>
<td> 21 </td>
<td> 5.8</td>
<td> 5.8</td>
<td> 5.8</td>
</tr>
</tbody>
</table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">dq</span><span class="o">&lt;-</span><span class="nf">DataQuality</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">dq</span><span class="o">$</span><span class="n">PairWiseQ</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.00    9.90   12.30   12.98   15.32   41.10 </pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>[<a href="00502/#contents">^top</a>]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Function-3:-Correlation-Test-">Function 3: Correlation Test <a name="f3"></a><a class="anchor-link" href="00502/#Function-3:-Correlation-Test-">¶</a>
</h3>
<p>The "Correlation" function will calculate the correlation coefficient and significance(correlation test) between the pollutants Sulfate and Nitrate for a range of minitor ids that meet required pair wise data quality.</p>
<p><strong>Input</strong></p>
<ol>
<li>pwq - Pair wise data quality in percentage. Default value is 0.</li>
<li>id - An <strong>optional</strong> Monitor id vector. Default value is 1:332.</li>
</ol>
<p><strong>Output</strong></p>
<ol>
<li>Pearson correlation test summary</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [128]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="n">Correlation</span><span class="o">&lt;-</span><span class="nf">function</span><span class="p">(</span><span class="n">pwq</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="n">id</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">332</span><span class="p">){</span>
    <span class="n">p</span><span class="o">&lt;-</span><span class="nf">c</span><span class="p">(</span><span class="s">"sulfate"</span><span class="p">,</span><span class="s">"nitrate"</span><span class="p">)</span>
    <span class="c1"># Init empty data frame</span>
    <span class="n">dfc</span><span class="o">&lt;-</span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">setNames</span><span class="p">(</span><span class="nf">replicate</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="nf">numeric</span><span class="p">(</span><span class="m">0</span><span class="p">),</span> <span class="n">simplify</span> <span class="o">=</span> <span class="bp">F</span><span class="p">),</span> <span class="n">p</span><span class="p">))</span>
    <span class="nf">for </span><span class="p">(</span><span class="n">i</span> <span class="n">in</span> <span class="n">id</span><span class="p">){</span>
        <span class="c1"># Reading each csv file into a dataframe.</span>
        <span class="n">df</span><span class="o">&lt;-</span><span class="nf">read.csv</span><span class="p">(</span><span class="nf">unz</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="nf">sprintf</span><span class="p">(</span><span class="s">"data/%03d.csv"</span><span class="p">,</span><span class="n">i</span><span class="p">)))</span>
        <span class="c1"># Pairwise complete obserations</span>
        <span class="n">dfpw</span><span class="o">&lt;-</span><span class="n">df</span><span class="p">[</span><span class="o">!</span><span class="p">(</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="m">1</span><span class="p">]])</span><span class="o">|</span><span class="nf">is.na</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="m">2</span><span class="p">]])),]</span>
        <span class="c1"># Checking if pairwise data quality of a monitor meets required pwq</span>
        <span class="nf">if </span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">dfpw</span><span class="p">)</span><span class="o">/</span><span class="nf">nrow</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">&gt;=</span><span class="n">pwq</span><span class="o">/</span><span class="m">100</span><span class="p">){</span>
            <span class="n">dfc</span><span class="o">&lt;-</span><span class="nf">rbind</span><span class="p">(</span><span class="n">dfc</span><span class="p">,</span><span class="n">dfpw</span><span class="p">[,</span><span class="n">p</span><span class="p">])</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1"># Pearson correlation test</span>
    <span class="nf">cor.test</span><span class="p">(</span><span class="n">dfc</span><span class="p">[,</span><span class="n">p</span><span class="p">[</span><span class="m">1</span><span class="p">]],</span><span class="n">y</span><span class="o">=</span><span class="n">dfc</span><span class="p">[,</span><span class="n">p</span><span class="p">[</span><span class="m">2</span><span class="p">]])</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [130]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Correlation test of monitors with pairwise data quality above the 35%</span>
<span class="nf">Correlation</span><span class="p">(</span><span class="m">35</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
	Pearson's product-moment correlation

data:  dfc[, p[1]] and dfc[, p[2]]
t = -2.0727, df = 148, p-value = 0.03993
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.319614399 -0.007907202
sample estimates:
       cor 
-0.1679559 
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [127]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Correlation test of monitors with pairwise data quality above the mean</span>
<span class="nf">Correlation</span><span class="p">(</span><span class="m">12.98</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
	Pearson's product-moment correlation

data:  dfc[, p[1]] and dfc[, p[2]]
t = 16.813, df = 73847, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.05456375 0.06893346
sample estimates:
      cor 
0.0617518 
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [129]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Correlation test of all monitors</span>
<span class="nf">Correlation</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_text output_subarea ">
<pre>
	Pearson's product-moment correlation

data:  dfc[, p[1]] and dfc[, p[2]]
t = 20.916, df = 111800, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.05659269 0.06827041
sample estimates:
       cor 
0.06243369 
</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-r"><pre><span></span><span class="c1"># Maximum pairwise data quality is 41.1%.</span>
<span class="c1"># Passing a value above that should give an eror.</span>
<span class="nf">Correlation</span><span class="p">(</span><span class="m">42</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_text output_error">
<pre>
Error in cor.test.default(dfc[, p[1]], y = dfc[, p[2]]): not enough finite observations
Traceback:

1. Correlation(42)
2. cor.test(dfc[, p[1]], y = dfc[, p[2]])   # at line 16 of file &lt;text&gt;
3. cor.test.default(dfc[, p[1]], y = dfc[, p[2]])
4. stop("not enough finite observations")</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>[<a href="00502/#contents">^top</a>]</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>Last updated 2020-04-17 22:16:01.288450 IST</em></p>

</div>
</div>
</div>
</div>
    </div>
    </article>
</div>

        <ul class="pager postindexpager clearfix">
<li class="previous"><a href="." rel="prev">Newer posts</a></li>
            <li class="next"><a href="index-2.html" rel="next">Older posts</a></li>
        </ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script><!--End of body content--><footer id="footer">
            Contents © 2020 Krishnakanth Allika 
<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
            
            
        </footer>
</div>
</div>


        <script src="../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
    </script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-163231811-1"></script><script>  window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);}  gtag('js', new Date());  gtag('config', 'UA-163231811-1'); gtag('set', {'user_id': 'USER_ID'});</script>
</body>
</html>
